<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ForceBalance: forcebalance/doc/mainpage.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ForceBalanceLogo_sm.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForceBalance
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">Automated optimization of force fields and empirical potentials</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/roadmap.html"><span>API</span></a></li>
      <li><a href="installation.html"><span>Installation</span></a></li>
      <li><a href="usage.html"><span>Usage</span></a></li>
      <li><a href="tutorial.html"><span>Tutorial</span></a></li>
      <li><a href="glossary.html"><span>Glossary</span></a></li>
      <li><a href="api/namespaces.html"><span>API</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">forcebalance/doc/mainpage.py</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">##</span>
<a name="l00002"></a>00002 <span class="comment"># </span>
<a name="l00003"></a>00003 <span class="comment"># </span>
<a name="l00004"></a>00004 <span class="comment"># @mainpage</span>
<a name="l00005"></a>00005 <span class="comment"># </span>
<a name="l00006"></a>00006 <span class="comment"># @section preface_sec Preface: How to use this document</span>
<a name="l00007"></a>00007 <span class="comment"># </span>
<a name="l00008"></a>00008 <span class="comment"># The documentation for %ForceBalance exists in two forms: a web page and</span>
<a name="l00009"></a>00009 <span class="comment"># a PDF manual.  They contain equivalent content.  The newest versions</span>
<a name="l00010"></a>00010 <span class="comment"># of the software and documentation, along with relevant literature, can</span>
<a name="l00011"></a>00011 <span class="comment"># be found on the &lt;a href=https://simtk.org/home/forcebalance/&gt;SimTK website&lt;/a&gt;.</span>
<a name="l00012"></a>00012 <span class="comment"># </span>
<a name="l00013"></a>00013 <span class="comment"># \b Users of the program should read the &lt;em&gt;Introduction,</span>
<a name="l00014"></a>00014 <span class="comment"># Installation&lt;/em&gt;, &lt;em&gt;Usage&lt;/em&gt;, and &lt;em&gt;Tutorial&lt;/em&gt; sections on</span>
<a name="l00015"></a>00015 <span class="comment"># the main page.</span>
<a name="l00016"></a>00016 <span class="comment"># </span>
<a name="l00017"></a>00017 <span class="comment"># &lt;b&gt;Developers and contributors&lt;/b&gt; should read the</span>
<a name="l00018"></a>00018 <span class="comment"># Introduction chapter, including the &lt;em&gt;Program Layout&lt;/em&gt; and</span>
<a name="l00019"></a>00019 <span class="comment"># &lt;em&gt;Creating Documentation&lt;/em&gt; sections.  The &lt;em&gt;API</span>
<a name="l00020"></a>00020 <span class="comment"># documentation&lt;/em&gt;, which describes all of the modules, classes and</span>
<a name="l00021"></a>00021 <span class="comment"># functions in the program, is intended as a reference</span>
<a name="l00022"></a>00022 <span class="comment"># for contributors who are writing code.</span>
<a name="l00023"></a>00023 <span class="comment"># </span>
<a name="l00024"></a>00024 <span class="comment"># %ForceBalance is a work in progress; using the program is nontrivial</span>
<a name="l00025"></a>00025 <span class="comment"># and many features are still being actively developed.  Thus, users and</span>
<a name="l00026"></a>00026 <span class="comment"># developers are highly encouraged to contact me through</span>
<a name="l00027"></a>00027 <span class="comment"># the &lt;a href=https://simtk.org/home/forcebalance/&gt;SimTK website&lt;/a&gt;, either by sending me email or posting to the</span>
<a name="l00028"></a>00028 <span class="comment"># public forum, in order to get things up and running.</span>
<a name="l00029"></a>00029 <span class="comment"># </span>
<a name="l00030"></a>00030 <span class="comment"># Thanks!</span>
<a name="l00031"></a>00031 <span class="comment"># </span>
<a name="l00032"></a>00032 <span class="comment"># Lee-Ping Wang</span>
<a name="l00033"></a>00033 <span class="comment"># </span>
<a name="l00034"></a>00034 <span class="comment"># @section intro_sec Introduction</span>
<a name="l00035"></a>00035 <span class="comment"># </span>
<a name="l00036"></a>00036 <span class="comment"># Welcome to %ForceBalance! :)</span>
<a name="l00037"></a>00037 <span class="comment"># </span>
<a name="l00038"></a>00038 <span class="comment"># This is a &lt;em&gt; theoretical and computational chemistry &lt;/em&gt; program</span>
<a name="l00039"></a>00039 <span class="comment"># primarily developed by Lee-Ping Wang.  The full list of people who</span>
<a name="l00040"></a>00040 <span class="comment"># made this project possible are given in the \ref credits.</span>
<a name="l00041"></a>00041 <span class="comment"># </span>
<a name="l00042"></a>00042 <span class="comment"># The function of %ForceBalance is &lt;em&gt;automatic force field</span>
<a name="l00043"></a>00043 <span class="comment"># optimization&lt;/em&gt;.  Here I will provide some background, which for the</span>
<a name="l00044"></a>00044 <span class="comment"># sake of brevity and readability will lack precision and details.  In</span>
<a name="l00045"></a>00045 <span class="comment"># the future, this documentation will include literature citations which</span>
<a name="l00046"></a>00046 <span class="comment"># will guide further reading.</span>
<a name="l00047"></a>00047 <span class="comment"># </span>
<a name="l00048"></a>00048 <span class="comment"># @subsection background Background: Empirical Potentials</span>
<a name="l00049"></a>00049 <span class="comment"># </span>
<a name="l00050"></a>00050 <span class="comment"># In theoretical and computational chemistry, there are many methods for</span>
<a name="l00051"></a>00051 <span class="comment"># computing the potential energy of a collection of atoms and molecules</span>
<a name="l00052"></a>00052 <span class="comment"># given their positions in space.  For a system of \a N particles, the</span>
<a name="l00053"></a>00053 <span class="comment"># potential energy surface (or &lt;em&gt;potential&lt;/em&gt; for short) is a</span>
<a name="l00054"></a>00054 <span class="comment"># function of the \a 3N variables that specify the atomic coordinates.</span>
<a name="l00055"></a>00055 <span class="comment"># The potential is the foundation for many types of atomistic</span>
<a name="l00056"></a>00056 <span class="comment"># simulations, including molecular dynamics and Monte Carlo, which are</span>
<a name="l00057"></a>00057 <span class="comment"># used to simulate all sorts of chemical and biochemical processes</span>
<a name="l00058"></a>00058 <span class="comment"># ranging from protein folding and enzyme catalysis to reactions between</span>
<a name="l00059"></a>00059 <span class="comment"># small molecules in interstellar clouds.</span>
<a name="l00060"></a>00060 <span class="comment"># </span>
<a name="l00061"></a>00061 <span class="comment"># The true potential is given by the energy eigenvalue of the</span>
<a name="l00062"></a>00062 <span class="comment"># time-independent Schrodinger&#39;s equation, but since the exact solution</span>
<a name="l00063"></a>00063 <span class="comment"># is intractable for virtually all systems of interest, approximate</span>
<a name="l00064"></a>00064 <span class="comment"># methods are used.  Some are &lt;em&gt;ab initio&lt;/em&gt; methods (&#39;from first</span>
<a name="l00065"></a>00065 <span class="comment"># principles&#39;) since they are derived directly from approximating</span>
<a name="l00066"></a>00066 <span class="comment"># Schrodinger&#39;s equation; examples include the independent electron</span>
<a name="l00067"></a>00067 <span class="comment"># approximation (Hartree-Fock) and perturbation theory (MP2).  However,</span>
<a name="l00068"></a>00068 <span class="comment"># most methods contain some tunable constants or &lt;em&gt;empirical</span>
<a name="l00069"></a>00069 <span class="comment"># parameters&lt;/em&gt; which are carefully chosen to make the method as</span>
<a name="l00070"></a>00070 <span class="comment"># accurate as possible.  Three examples: the widely used B3LYP</span>
<a name="l00071"></a>00071 <span class="comment"># approximation in density functional theory (DFT) contains three</span>
<a name="l00072"></a>00072 <span class="comment"># parameters, the semiempirical PM3 method has 10-20 parameters per</span>
<a name="l00073"></a>00073 <span class="comment"># chemical element, and classical force fields have hundreds to</span>
<a name="l00074"></a>00074 <span class="comment"># thousands of parameters.  All such formulations require an accurate</span>
<a name="l00075"></a>00075 <span class="comment"># parameterization to properly describe reality.</span>
<a name="l00076"></a>00076 <span class="comment"># </span>
<a name="l00077"></a>00077 <span class="comment"># \image html ladder_sm.png &quot;An arrangement of simulation methods by accuracy vs. computational cost.&quot;</span>
<a name="l00078"></a>00078 <span class="comment"># \image latex ladder.png &quot;An arrangement of simulation methods by accuracy vs. computational cost.&quot; width=10cm</span>
<a name="l00079"></a>00079 <span class="comment"># </span>
<a name="l00080"></a>00080 <span class="comment"># The main audience of %ForceBalance is the scientific community that</span>
<a name="l00081"></a>00081 <span class="comment"># uses and develops classical force fields.  These force fields do not</span>
<a name="l00082"></a>00082 <span class="comment"># use the Schrodinger&#39;s equation as a starting point; instead, the</span>
<a name="l00083"></a>00083 <span class="comment"># potential is entirely specified using elementary mathematical</span>
<a name="l00084"></a>00084 <span class="comment"># functions.  Thus, the rigorous physical foundation is sacrificed but</span>
<a name="l00085"></a>00085 <span class="comment"># the computational cost is reduced by a factor of millions, enabling</span>
<a name="l00086"></a>00086 <span class="comment"># atomic-resolution simulations of large biomolecules on long timescales</span>
<a name="l00087"></a>00087 <span class="comment"># and allowing the study of problems like protein folding.</span>
<a name="l00088"></a>00088 <span class="comment"># </span>
<a name="l00089"></a>00089 <span class="comment"># In classical force fields, relatively few parameters may be determined</span>
<a name="l00090"></a>00090 <span class="comment"># directly from experiment - for instance, a chemical bond may be</span>
<a name="l00091"></a>00091 <span class="comment"># described using a harmonic spring with the experimental bond length</span>
<a name="l00092"></a>00092 <span class="comment"># and vibrational frequency.  More often there is no experimentally</span>
<a name="l00093"></a>00093 <span class="comment"># measurable counterpart to a parameter - for example, electrostatic</span>
<a name="l00094"></a>00094 <span class="comment"># interactions are often described as Coulomb interactions between pairs</span>
<a name="l00095"></a>00095 <span class="comment"># of atomic point &quot;partial charges&quot;, but the fractional charge assigned</span>
<a name="l00096"></a>00096 <span class="comment"># to each atom has no rigorous experimental of theoretical definition.</span>
<a name="l00097"></a>00097 <span class="comment"># To complicate matters further, most molecular motions arise from a</span>
<a name="l00098"></a>00098 <span class="comment"># combination of interactions and are sensitive to many parameters at</span>
<a name="l00099"></a>00099 <span class="comment"># once - for example, the dihedral interaction term is intended to</span>
<a name="l00100"></a>00100 <span class="comment"># govern torsional motion about a bond, but these motions are modulated</span>
<a name="l00101"></a>00101 <span class="comment"># by the flexibility of the nearby bond and angle interactions as well</span>
<a name="l00102"></a>00102 <span class="comment"># as the nonbonded interactions on either side.</span>
<a name="l00103"></a>00103 <span class="comment"># </span>
<a name="l00104"></a>00104 <span class="comment"># \image html interactions_sm.png &quot;An illustration of some interactions typically found in classical force fields.&quot;</span>
<a name="l00105"></a>00105 <span class="comment"># \image latex interactions.png &quot;An illustration of some interactions typically found in classical force fields.&quot; width=10cm</span>
<a name="l00106"></a>00106 <span class="comment"># </span>
<a name="l00107"></a>00107 <span class="comment"># For all of these reasons, force field parameterization is difficult.</span>
<a name="l00108"></a>00108 <span class="comment"># In the current practice, parameters are often determined by fitting to</span>
<a name="l00109"></a>00109 <span class="comment"># results from other calculations (for example, restrained electrostatic</span>
<a name="l00110"></a>00110 <span class="comment"># potential fitting (RESP) for determining the partial charges) or</span>
<a name="l00111"></a>00111 <span class="comment"># chosen so that the simulation results match experimental measurements</span>
<a name="l00112"></a>00112 <span class="comment"># (for example, adjusting the partial charges on a solvent molecule to</span>
<a name="l00113"></a>00113 <span class="comment"># reproduce the bulk dielectric constant.)  Published force fields have</span>
<a name="l00114"></a>00114 <span class="comment"># been modified by hand over decades to maximize their agreement with</span>
<a name="l00115"></a>00115 <span class="comment"># experimental observations (for example, adjusting some parameters in</span>
<a name="l00116"></a>00116 <span class="comment"># order to reproduce particular protein NMR structure) at the expense of</span>
<a name="l00117"></a>00117 <span class="comment"># reproducibility.</span>
<a name="l00118"></a>00118 <span class="comment"># </span>
<a name="l00119"></a>00119 <span class="comment"># @subsection mission_statement Purpose and brief description of this program </span>
<a name="l00120"></a>00120 <span class="comment"># </span>
<a name="l00121"></a>00121 <span class="comment"># Given this background, I can make the following statement.  &lt;b&gt;The</span>
<a name="l00122"></a>00122 <span class="comment"># purpose of %ForceBalance is to create force fields by applying a highly</span>
<a name="l00123"></a>00123 <span class="comment"># general and systematic process with explicitly specified input data</span>
<a name="l00124"></a>00124 <span class="comment"># and optimization methods, paving the way to higher accuracy and</span>
<a name="l00125"></a>00125 <span class="comment"># improved reproducibility. &lt;/b&gt;</span>
<a name="l00126"></a>00126 <span class="comment"># </span>
<a name="l00127"></a>00127 <span class="comment"># At a high level, %ForceBalance takes an empirical potential and a set</span>
<a name="l00128"></a>00128 <span class="comment"># of reference data as inputs, and tunes the parameters such that the</span>
<a name="l00129"></a>00129 <span class="comment"># simulations are able to reproduce the data as accurately as possible.</span>
<a name="l00130"></a>00130 <span class="comment"># Examples of reference data include energy and forces from high-level</span>
<a name="l00131"></a>00131 <span class="comment"># QM calculations, experimentally known molecular properties</span>
<a name="l00132"></a>00132 <span class="comment"># (e.g. polarizabilities and multipole moments), and experimentally</span>
<a name="l00133"></a>00133 <span class="comment"># measured bulk properties (e.g. density and dielectric constant).</span>
<a name="l00134"></a>00134 <span class="comment"># </span>
<a name="l00135"></a>00135 <span class="comment"># %ForceBalance presents the problem of potential optimization in a</span>
<a name="l00136"></a>00136 <span class="comment"># unified and easily extensible framework.  Since there are many</span>
<a name="l00137"></a>00137 <span class="comment"># empirical potentials in theoretical chemistry and similarly many types</span>
<a name="l00138"></a>00138 <span class="comment"># of reference data, significant effort is taken to provide an</span>
<a name="l00139"></a>00139 <span class="comment"># infrastructure which allows a researcher to fit any type of</span>
<a name="l00140"></a>00140 <span class="comment"># potential to any type of reference data.</span>
<a name="l00141"></a>00141 <span class="comment"># </span>
<a name="l00142"></a>00142 <span class="comment"># Conceptually, a set of reference data (usually a physical quantity of</span>
<a name="l00143"></a>00143 <span class="comment"># some kind), in combination with a method for computing the</span>
<a name="l00144"></a>00144 <span class="comment"># corresponding quantity with the force field, is called a</span>
<a name="l00145"></a>00145 <span class="comment"># &lt;b&gt;target&lt;/b&gt;.  For example:</span>
<a name="l00146"></a>00146 <span class="comment"># </span>
<a name="l00147"></a>00147 <span class="comment"># - A force field can predict the density of a liquid by running NPT</span>
<a name="l00148"></a>00148 <span class="comment"># molecular dynamics, and this computed value can be compared against</span>
<a name="l00149"></a>00149 <span class="comment"># the experimental density.</span>
<a name="l00150"></a>00150 <span class="comment"># </span>
<a name="l00151"></a>00151 <span class="comment"># - A force field can be used to evaluate the energies and forces at</span>
<a name="l00152"></a>00152 <span class="comment"># several molecular geometries, and these can be compared against</span>
<a name="l00153"></a>00153 <span class="comment"># energies and forces from higher-level quantum chemistry calculations</span>
<a name="l00154"></a>00154 <span class="comment"># using these same geometries.  This is known as &lt;b&gt;force and energy</span>
<a name="l00155"></a>00155 <span class="comment"># matching&lt;/b&gt;.</span>
<a name="l00156"></a>00156 <span class="comment"># </span>
<a name="l00157"></a>00157 <span class="comment"># - A force field can predict the multipole moments and polarizabilities</span>
<a name="l00158"></a>00158 <span class="comment"># of a molecule isolated in vacuum, and these can be compared against</span>
<a name="l00159"></a>00159 <span class="comment"># experimental measurements.</span>
<a name="l00160"></a>00160 <span class="comment"># </span>
<a name="l00161"></a>00161 <span class="comment"># Within a target, the accuracy of the force</span>
<a name="l00162"></a>00162 <span class="comment"># field can be optimized by tuning the parameters to minimize the</span>
<a name="l00163"></a>00163 <span class="comment"># difference between the computed and reference quantities.  One or more</span>
<a name="l00164"></a>00164 <span class="comment"># targets can be combined to produce an aggregate</span>
<a name="l00165"></a>00165 <span class="comment"># &lt;b&gt;objective function&lt;/b&gt; whose domain is the &lt;b&gt;parameter space&lt;/b&gt;.</span>
<a name="l00166"></a>00166 <span class="comment"># This objective function, which typically depends on the parameters in</span>
<a name="l00167"></a>00167 <span class="comment"># a complex way, is minimized using nonlinear optimization algorithms.</span>
<a name="l00168"></a>00168 <span class="comment"># The result is a force field with high accuracy in all of the fitting</span>
<a name="l00169"></a>00169 <span class="comment"># simulations.</span>
<a name="l00170"></a>00170 <span class="comment"># </span>
<a name="l00171"></a>00171 <span class="comment"># \image html flowchart_sm.png &quot;The division of the potential optimization problem into three parts; the force field, targets and optimization algorithm.&quot;</span>
<a name="l00172"></a>00172 <span class="comment"># \image latex flowchart.png &quot;The division of the potential optimization problem into three parts; the force field, targets and optimization algorithm.&quot; height=10cm</span>
<a name="l00173"></a>00173 <span class="comment"># </span>
<a name="l00174"></a>00174 <span class="comment"># The problem is now split into three main components; the force field,</span>
<a name="l00175"></a>00175 <span class="comment"># the targets, and the optimization algorithm.  %ForceBalance</span>
<a name="l00176"></a>00176 <span class="comment"># uses this conceptual division to define three classes with minimal</span>
<a name="l00177"></a>00177 <span class="comment"># interdependence.  Thus, if a researcher wishes to explore a new</span>
<a name="l00178"></a>00178 <span class="comment"># functional form, incorporate a new type of reference data or try a new</span>
<a name="l00179"></a>00179 <span class="comment"># optimization algorithm, he or she would only need to contribute to one</span>
<a name="l00180"></a>00180 <span class="comment"># branch of the program without having to restructure the entire code</span>
<a name="l00181"></a>00181 <span class="comment"># base.</span>
<a name="l00182"></a>00182 <span class="comment"># </span>
<a name="l00183"></a>00183 <span class="comment"># The scientific problems and concepts that this program is based upon</span>
<a name="l00184"></a>00184 <span class="comment"># are further described in my Powerpoint presentations and publications,</span>
<a name="l00185"></a>00185 <span class="comment"># which can be found on the &lt;a href=https://simtk.org/home/forcebalance/&gt;SimTK website&lt;/a&gt;.</span>
<a name="l00186"></a>00186 <span class="comment"># </span>
<a name="l00187"></a>00187 <span class="comment"># @section credits Credits</span>
<a name="l00188"></a>00188 <span class="comment"># </span>
<a name="l00189"></a>00189 <span class="comment"># - Lee-Ping Wang is the principal developer and author.</span>
<a name="l00190"></a>00190 <span class="comment"># </span>
<a name="l00191"></a>00191 <span class="comment"># - Troy Van Voorhis provided scientific guidance and many of</span>
<a name="l00192"></a>00192 <span class="comment"># the central ideas as well as financial support.</span>
<a name="l00193"></a>00193 <span class="comment"># </span>
<a name="l00194"></a>00194 <span class="comment"># - Jiahao Chen contributed the call graph generator, the QTPIE</span>
<a name="l00195"></a>00195 <span class="comment"># fluctuating-charge force field (which Lee-Ping implemented into</span>
<a name="l00196"></a>00196 <span class="comment"># GROMACS), the interface to the MOPAC semiempirical code, and many</span>
<a name="l00197"></a>00197 <span class="comment"># helpful discussions.</span>
<a name="l00198"></a>00198 <span class="comment"># </span>
<a name="l00199"></a>00199 <span class="comment"># - Matt Welborn contributed the parallelization-over-snapshots</span>
<a name="l00200"></a>00200 <span class="comment"># functionality in the general force matching module.</span>
<a name="l00201"></a>00201 <span class="comment"># </span>
<a name="l00202"></a>00202 <span class="comment"># - Vijay Pande provided scientific guidance and financial support,</span>
<a name="l00203"></a>00203 <span class="comment"># and through the SimBios program gave this software a home on the Web</span>
<a name="l00204"></a>00204 <span class="comment"># at the &lt;a href=https://simtk.org/home/forcebalance/&gt;SimTK website&lt;/a&gt;.</span>
<a name="l00205"></a>00205 <span class="comment"># </span>
<a name="l00206"></a>00206 <span class="comment"># - Todd Martinez provided scientific guidance and financial support.</span>
<a name="l00207"></a>00207 <span class="comment"># \page installation Installation</span>
<a name="l00208"></a>00208 <span class="comment"># </span>
<a name="l00209"></a>00209 <span class="comment"># This section covers how to install %ForceBalance.  Currently only Linux</span>
<a name="l00210"></a>00210 <span class="comment"># is supported, though installation on other Unix-based systems</span>
<a name="l00211"></a>00211 <span class="comment"># (e.g. Mac OS) should also be straightforward.</span>
<a name="l00212"></a>00212 <span class="comment"># </span>
<a name="l00213"></a>00213 <span class="comment"># Importantly, note that &lt;em&gt;%ForceBalance does not contain a simulation</span>
<a name="l00214"></a>00214 <span class="comment"># engine&lt;/em&gt;.  Instead it interfaces with simulation software like</span>
<a name="l00215"></a>00215 <span class="comment"># GROMACS, TINKER, AMBER or OpenMM; reference data is obtained from</span>
<a name="l00216"></a>00216 <span class="comment"># experimental measurements (consult the literature) or from quantum</span>
<a name="l00217"></a>00217 <span class="comment"># chemistry software (for example, NWChem or Q-Chem).</span>
<a name="l00218"></a>00218 <span class="comment"># </span>
<a name="l00219"></a>00219 <span class="comment"># Several interfaces to existing software packages are provided.</span>
<a name="l00220"></a>00220 <span class="comment"># However, if you use %ForceBalance for a research project, you should be</span>
<a name="l00221"></a>00221 <span class="comment"># prepared to write some simple Python code to interface with a software</span>
<a name="l00222"></a>00222 <span class="comment"># package of your choice.  If you choose to do so, please contact me as</span>
<a name="l00223"></a>00223 <span class="comment"># I would be happy to include your contribution in the main</span>
<a name="l00224"></a>00224 <span class="comment"># distribution.</span>
<a name="l00225"></a>00225 <span class="comment"># </span>
<a name="l00226"></a>00226 <span class="comment"># @section installing_forcebalance Installing ForceBalance</span>
<a name="l00227"></a>00227 <span class="comment"># </span>
<a name="l00228"></a>00228 <span class="comment"># %ForceBalance is packaged as a Python module.  Here are the installation instructions.  </span>
<a name="l00229"></a>00229 <span class="comment"># </span>
<a name="l00230"></a>00230 <span class="comment"># A quick preface: Installing software can be a real pain.  I tried to make %ForceBalance easy to install by providing clear instructions and minimizing the number of dependencies; however, complications and challenges during installation happen all the time.  If you are running into installation problems or having trouble resolving a dependency, please contact me.</span>
<a name="l00231"></a>00231 <span class="comment"># </span>
<a name="l00232"></a>00232 <span class="comment"># @subsection installing_forcebalance_prereq Prerequisites</span>
<a name="l00233"></a>00233 <span class="comment"># </span>
<a name="l00234"></a>00234 <span class="comment"># %ForceBalance requires the following software packages:</span>
<a name="l00235"></a>00235 <span class="comment"># </span>
<a name="l00236"></a>00236 <span class="comment"># @li &lt;a href=http://www.python.org/&gt;Python&lt;/a&gt; version 2.7</span>
<a name="l00237"></a>00237 <span class="comment"># @li &lt;a href=http://numpy.scipy.org/&gt;NumPy&lt;/a&gt; version 1.5</span>
<a name="l00238"></a>00238 <span class="comment"># @li &lt;a href=http://www.scipy.org/&gt;SciPy&lt;/a&gt; version 0.9</span>
<a name="l00239"></a>00239 <span class="comment"># </span>
<a name="l00240"></a>00240 <span class="comment"># The following packages are required for certain functionality:</span>
<a name="l00241"></a>00241 <span class="comment"># </span>
<a name="l00242"></a>00242 <span class="comment"># @li &lt;a href=http://lxml.de/&gt;lxml&lt;/a&gt; version 2.3.4 - Python interface to libxml2 for parsing OpenMM force field files</span>
<a name="l00243"></a>00243 <span class="comment"># @li &lt;a href=http://nd.edu/~ccl/software/&gt;cctools&lt;/a&gt; version 3.4.1 - Cooperative Computing Tools from Notre Dame for distributed computing</span>
<a name="l00244"></a>00244 <span class="comment"># </span>
<a name="l00245"></a>00245 <span class="comment"># The following packages are used for documentation:</span>
<a name="l00246"></a>00246 <span class="comment"># </span>
<a name="l00247"></a>00247 <span class="comment"># @li &lt;a href=http://www.stack.nl/~dimitri/doxygen/&gt;Doxygen&lt;/a&gt; version 1.7.6.1</span>
<a name="l00248"></a>00248 <span class="comment"># @li &lt;a href=http://code.foosel.org/doxypy&gt;Doxypy&lt;/a&gt; plugin for Doxygen</span>
<a name="l00249"></a>00249 <span class="comment"># @li LaTeX software such as &lt;a href=http://www.tug.org/texlive/&gt;TeXLive&lt;/a&gt;</span>
<a name="l00250"></a>00250 <span class="comment"># </span>
<a name="l00251"></a>00251 <span class="comment"># @subsection installing_forcebalance_install Installing</span>
<a name="l00252"></a>00252 <span class="comment"># </span>
<a name="l00253"></a>00253 <span class="comment"># To install the package, first extract the tarball that you downloaded from the</span>
<a name="l00254"></a>00254 <span class="comment"># webpage using the command:</span>
<a name="l00255"></a>00255 <span class="comment"># </span>
<a name="l00256"></a>00256 <span class="comment"># @verbatim tar xvzf ForceBalance-[version].tar.gz @endverbatim</span>
<a name="l00257"></a>00257 <span class="comment"># </span>
<a name="l00258"></a>00258 <span class="comment"># Alternatively, download the newest Subversion revision from the SimTK website:</span>
<a name="l00259"></a>00259 <span class="comment"># </span>
<a name="l00260"></a>00260 <span class="comment"># @verbatim svn checkout https://simtk.org/svn/forcebalance @endverbatim</span>
<a name="l00261"></a>00261 <span class="comment"># </span>
<a name="l00262"></a>00262 <span class="comment"># Upon extracting the distribution you will see this directory structure:</span>
<a name="l00263"></a>00263 <span class="comment"># </span>
<a name="l00264"></a>00264 <span class="comment"># @verbatim</span>
<a name="l00265"></a>00265 <span class="comment"># &lt;root&gt;</span>
<a name="l00266"></a>00266 <span class="comment">#   +- bin</span>
<a name="l00267"></a>00267 <span class="comment">#   |   |- &lt;Executable scripts&gt;</span>
<a name="l00268"></a>00268 <span class="comment">#   +- src</span>
<a name="l00269"></a>00269 <span class="comment">#   |   |- &lt;ForceBalance source files&gt;</span>
<a name="l00270"></a>00270 <span class="comment">#   +- ext</span>
<a name="l00271"></a>00271 <span class="comment">#   |   |- &lt;Extensions; self-contained software packages that are used by ForceBalance&gt;</span>
<a name="l00272"></a>00272 <span class="comment">#   +- studies</span>
<a name="l00273"></a>00273 <span class="comment">#   |   +- &lt;ForceBalance example jobs&gt;</span>
<a name="l00274"></a>00274 <span class="comment">#   +- doc</span>
<a name="l00275"></a>00275 <span class="comment">#   |   +- callgraph</span>
<a name="l00276"></a>00276 <span class="comment">#   |   |   |- &lt;Stuff for making a call graph&gt;</span>
<a name="l00277"></a>00277 <span class="comment">#   |   +- Images</span>
<a name="l00278"></a>00278 <span class="comment">#   |   |   |- &lt;Images for the website and PDF manual&gt;</span>
<a name="l00279"></a>00279 <span class="comment">#   |   |- make-all-documentation.sh (Create the documentation)</span>
<a name="l00280"></a>00280 <span class="comment">#   |   |- &lt;Below are documentation chapters in Doxygen format&gt;</span>
<a name="l00281"></a>00281 <span class="comment">#   |   |- introduction.txt</span>
<a name="l00282"></a>00282 <span class="comment">#   |   |- installation.txt</span>
<a name="l00283"></a>00283 <span class="comment">#   |   |- usage.txt</span>
<a name="l00284"></a>00284 <span class="comment">#   |   |- tutorial.txt</span>
<a name="l00285"></a>00285 <span class="comment">#   |   |- glossary.txt</span>
<a name="l00286"></a>00286 <span class="comment">#   |   |- &lt;The above files are concatenated into mainpage.py&gt;</span>
<a name="l00287"></a>00287 <span class="comment">#   |   |- make-all-documentation.sh (Command for making all documentation)</span>
<a name="l00288"></a>00288 <span class="comment">#   |   |- make-option-index.py (Create the option index documentation chapter)</span>
<a name="l00289"></a>00289 <span class="comment">#   |   |- header.tex (Customize the LaTex documentation)</span>
<a name="l00290"></a>00290 <span class="comment">#   |   |- add-tabs.py (Adds more navigation tabs to the webpage)</span>
<a name="l00291"></a>00291 <span class="comment">#   |   |- DoxygenLayout.xml (Removes a navigation tab from the webpage)</span>
<a name="l00292"></a>00292 <span class="comment">#   |   |- doxygen.cfg (Main configuration file for Doxygen)</span>
<a name="l00293"></a>00293 <span class="comment">#   |   |- ForceBalance-Manual.pdf (PDF manual, but the one on the SimTK website is probably newer)</span>
<a name="l00294"></a>00294 <span class="comment">#   |- PKG-INFO (Auto-generated package information)</span>
<a name="l00295"></a>00295 <span class="comment">#   |- README.txt (Points to the SimTK website)</span>
<a name="l00296"></a>00296 <span class="comment">#   |- setup.py (Python script for installation) @endverbatim</span>
<a name="l00297"></a>00297 <span class="comment"># </span>
<a name="l00298"></a>00298 <span class="comment"># To install the code into your default Python location, run this (you might need to be root):</span>
<a name="l00299"></a>00299 <span class="comment"># </span>
<a name="l00300"></a>00300 <span class="comment"># @verbatim python setup.py install @endverbatim</span>
<a name="l00301"></a>00301 <span class="comment"># </span>
<a name="l00302"></a>00302 <span class="comment"># You might not have root permissions, or you may want to install the package somewhere other than the default location.  You can install to a custom location (for example, to /home/leeping/local) by running:</span>
<a name="l00303"></a>00303 <span class="comment"># </span>
<a name="l00304"></a>00304 <span class="comment"># @verbatim python setup.py install --prefix=/home/leeping/local @endverbatim</span>
<a name="l00305"></a>00305 <span class="comment"># </span>
<a name="l00306"></a>00306 <span class="comment"># Assuming your Python version is 2.7, the executable scripts will be placed into &lt;tt&gt;/home/leeping/local/bin&lt;/tt&gt; and the module will be placed into &lt;tt&gt;/home/leeping/local/lib/python2.7/site-packages/forcebalance&lt;/tt&gt;.</span>
<a name="l00307"></a>00307 <span class="comment"># </span>
<a name="l00308"></a>00308 <span class="comment"># Note that Python does not always recognize installed modules in custom locations.  Any one of the three below options will work for adding custom locations to the Python search path for installed modules:</span>
<a name="l00309"></a>00309 <span class="comment"># </span>
<a name="l00310"></a>00310 <span class="comment"># @verbatim ln -s /home/leeping/local /home/leeping/.local @endverbatim</span>
<a name="l00311"></a>00311 <span class="comment"># @verbatim export PYTHONUSERBASE=/home/leeping/local @endverbatim</span>
<a name="l00312"></a>00312 <span class="comment"># @verbatim export PYTHONPATH=$PYTHONPATH:/home/leeping/local/lib/python2.7 @endverbatim</span>
<a name="l00313"></a>00313 <span class="comment"># </span>
<a name="l00314"></a>00314 <span class="comment"># As with the installation of any software, there are potential issues with dependencies (for example, scipy and lxml.)  One way to resolve dependencies is to use the Enthought Python Distribution (EPD), which contains all of the required packages and is free for academic users.  Install EPD from the &lt;a href=http://www.enthought.com/products/epd.php&gt;Enthought website&lt;/a&gt;.  Configure your environment by running both of the commands below (assuming Enthought was installed to &lt;tt&gt; /home/leeping/opt/epd-7.3.2 &lt;/tt&gt;, with the python executable in the \c bin subdirectory):</span>
<a name="l00315"></a>00315 <span class="comment"># </span>
<a name="l00316"></a>00316 <span class="comment"># @verbatim</span>
<a name="l00317"></a>00317 <span class="comment"># export PATH=/home/leeping/opt/epd-7.3.2/bin:$PATH</span>
<a name="l00318"></a>00318 <span class="comment"># export PYTHONUSERBASE=/home/leeping/opt/epd-7.3.2 @endverbatim</span>
<a name="l00319"></a>00319 <span class="comment"># </span>
<a name="l00320"></a>00320 <span class="comment"># Once you have done this, the Numpy, Scipy and lxml dependency issues should be resolved and %ForceBalance will run without any problems.</span>
<a name="l00321"></a>00321 <span class="comment"># </span>
<a name="l00322"></a>00322 <span class="comment"># Here are a list of installation notes (not required if you install %ForceBalance into the Enthought Python Distribution).  These notes assume that Python and other packages are installed into $HOME/local.</span>
<a name="l00323"></a>00323 <span class="comment"># </span>
<a name="l00324"></a>00324 <span class="comment"># @li The installation of Numpy, Scipy and lxml may be facilitated by installing the \c pip package - simply run a command like &lt;tt&gt;pip install numpy&lt;/tt&gt;.</span>
<a name="l00325"></a>00325 <span class="comment"># @li Scipy requires a BLAS (Basic Linear Algebra Subroutines) library to be installed.  On certain Linux distributions such as Ubuntu, the BLAS libraries and headers can be found on the repository (run &lt;tt&gt;sudo apt-get install libblas-dev&lt;/tt&gt;).  Also, BLAS is provided by libraries such as ATLAS (Automatically Tuned Linear Algebra Software) or the Intel MKL (Math Kernel Library) for Intel processors.  To compile Scipy with Intel&#39;s MKL, follow the guide on &lt;a href=http://software.intel.com/en-us/articles/numpy-scipy-with-mkl&gt;Intel&#39;s website&lt;/a&gt;.  To use ATLAS, install the package from the &lt;a href=http://math-atlas.sourceforge.net&gt; ATLAS website &lt;/a&gt; and set the ATLAS environment variable (for example, &lt;tt&gt;export ATLAS=$HOME/local/lib/libatlas.so&lt;/tt&gt;) before installing Scipy.</span>
<a name="l00326"></a>00326 <span class="comment"># @li \c lxml is a Python interface to the libxml2 XML parser.  After much ado, I decided to use \c lxml instead of the \c xml module in Python&#39;s standard library for several reasons (\c xml contains only limited support for XPath, scrambles the ordering of attributes in an element, etc.)  The downside is that it can be harder to install.  Installation instructions can be found on the &lt;a href=http://lxml.de/installation.html&gt; lxml website&lt;/a&gt; but summarized here.  The packages \c libxml2 and \c libxslt need to be installed first, and in that order.  On Ubuntu, run &lt;tt&gt;sudo apt-get install libxml2-dev libxslt1-dev&lt;/tt&gt;.  To compile from source, run &lt;tt&gt;./configure --prefix=$HOME/local --with-python=$HOME/local&lt;/tt&gt;.  Then run \c make followed by &lt;tt&gt;make install&lt;/tt&gt;.  Python itself needs to be compiled with \c --enable-shared for this to work.  Finally, download and unzip \c lxml, then run &lt;tt&gt; python setup.py install --prefix=$HOME/local &lt;/tt&gt;.</span>
<a name="l00327"></a>00327 <span class="comment"># </span>
<a name="l00328"></a>00328 <span class="comment"># @section create_doc Create documentation</span>
<a name="l00329"></a>00329 <span class="comment"># </span>
<a name="l00330"></a>00330 <span class="comment"># This documentation is created by Doxygen with the Doxypy plugin.</span>
<a name="l00331"></a>00331 <span class="comment"># To create new documentation or expand on what&#39;s here, follow the</span>
<a name="l00332"></a>00332 <span class="comment"># examples in the source code or visit the Doxygen home page.</span>
<a name="l00333"></a>00333 <span class="comment"># </span>
<a name="l00334"></a>00334 <span class="comment"># To create this documentation from the source files, go to the \c doc</span>
<a name="l00335"></a>00335 <span class="comment"># directory in the distribution and run &lt;tt&gt; doxygen doxygen.cfg &lt;/tt&gt;</span>
<a name="l00336"></a>00336 <span class="comment"># to generate the HTML documentation and LaTeX source files.  Run the \c</span>
<a name="l00337"></a>00337 <span class="comment"># add-tabs.py script to generate the extra navigation tabs for the HTML</span>
<a name="l00338"></a>00338 <span class="comment"># documentation.  Then go to the \c latex directory and type in</span>
<a name="l00339"></a>00339 <span class="comment"># &lt;tt&gt;make&lt;/tt&gt; to build the PDF manual (You will need a LaTeX</span>
<a name="l00340"></a>00340 <span class="comment"># distribution for this.)  All of this is automated by running \c make-all-documentation.sh.</span>
<a name="l00341"></a>00341 <span class="comment"># </span>
<a name="l00342"></a>00342 <span class="comment"># @section install_gmxx2 Installing GROMACS-X2</span>
<a name="l00343"></a>00343 <span class="comment"># </span>
<a name="l00344"></a>00344 <span class="comment"># &lt;em&gt; GROMACS-X2 is not required for %ForceBalance and is currently deprecated.  Installation is not recommended.  This section is retained for your information and in case I choose to revive the software. &lt;/em&gt;</span>
<a name="l00345"></a>00345 <span class="comment"># </span>
<a name="l00346"></a>00346 <span class="comment"># I have provided a specialized version of GROMACS (dubbed version</span>
<a name="l00347"></a>00347 <span class="comment"># 4.0.7-X2) on the &lt;a href=https://simtk.org/home/forcebalance/&gt;SimTK</span>
<a name="l00348"></a>00348 <span class="comment"># website&lt;/a&gt; which interfaces with %ForceBalance through the</span>
<a name="l00349"></a>00349 <span class="comment"># abinitio_gmxx2 module.  Although interfacing with unmodified</span>
<a name="l00350"></a>00350 <span class="comment"># simulation software is straightforward, GROMACS-X2 is optimized for</span>
<a name="l00351"></a>00351 <span class="comment"># force field optimization and makes things much faster.  </span>
<a name="l00352"></a>00352 <span class="comment"># </span>
<a name="l00353"></a>00353 <span class="comment"># GROMACS-X2 contains major modifications from GROMACS 4.0.7.</span>
<a name="l00354"></a>00354 <span class="comment"># Most importantly, it enables computation of the objective function</span>
<a name="l00355"></a>00355 <span class="comment"># &lt;a&gt;and its analytic derivatives&lt;/a&gt; for rapid energy and force matching.  There</span>
<a name="l00356"></a>00356 <span class="comment"># is also an implementation of the QTPIE fluctuating-charge polarizable</span>
<a name="l00357"></a>00357 <span class="comment"># force field, and the beginnings of a GROMACS/Q-Chem interface</span>
<a name="l00358"></a>00358 <span class="comment"># (carefully implemented but not extensively tested).  Most of the</span>
<a name="l00359"></a>00359 <span class="comment"># changes were added in several new source files (less than ten): \c</span>
<a name="l00360"></a>00360 <span class="comment"># qtpie.c, \c fortune.c, \c fortune_utils.c, \c fortune_vsite.c, \c</span>
<a name="l00361"></a>00361 <span class="comment"># fortune_nb_utils.c, \c zmatrix.c and their corresponding header files,</span>
<a name="l00362"></a>00362 <span class="comment"># and \c fortunerec.h for the force matching data structure.  The name &#39;fortune&#39;</span>
<a name="l00363"></a>00363 <span class="comment"># derives from back when this code was called ForTune.</span>
<a name="l00364"></a>00364 <span class="comment"># </span>
<a name="l00365"></a>00365 <span class="comment"># The force matching functions are turned on by calling \c mdrun with</span>
<a name="l00366"></a>00366 <span class="comment"># the command line argument \c &#39;-fortune&#39; ; without this option, there</span>
<a name="l00367"></a>00367 <span class="comment"># should be no impact on the performance of normal MD simulations.</span>
<a name="l00368"></a>00368 <span class="comment"># </span>
<a name="l00369"></a>00369 <span class="comment"># %ForceBalance interfaces with GROMACS-X2 through the functions in</span>
<a name="l00370"></a>00370 <span class="comment"># \c abinitio_gmxx2.py ; the objective function and</span>
<a name="l00371"></a>00371 <span class="comment"># derivatives are computed and printed to output files.  The interface</span>
<a name="l00372"></a>00372 <span class="comment"># is defined in \c fortune.c on the GROMACS side.  %ForceBalance needs to know</span>
<a name="l00373"></a>00373 <span class="comment"># where the GROMACS-X2 executables are located, and this is specified</span>
<a name="l00374"></a>00374 <span class="comment"># using the \c gmxpath option in the input file.</span>
<a name="l00375"></a>00375 <span class="comment"># </span>
<a name="l00376"></a>00376 <span class="comment"># @subsection install_gmxx2_prerequisites Prerequisites for GROMACS-X2</span>
<a name="l00377"></a>00377 <span class="comment"># </span>
<a name="l00378"></a>00378 <span class="comment"># GROMACS-X2 needs the base GROMACS requirements and several other libraries.</span>
<a name="l00379"></a>00379 <span class="comment"># </span>
<a name="l00380"></a>00380 <span class="comment"># @li FFTW version 3.3</span>
<a name="l00381"></a>00381 <span class="comment"># @li GLib version 2.0</span>
<a name="l00382"></a>00382 <span class="comment"># @li Intel MKL library</span>
<a name="l00383"></a>00383 <span class="comment"># </span>
<a name="l00384"></a>00384 <span class="comment"># GLib is the utility library provided by the GNOME foundation (the</span>
<a name="l00385"></a>00385 <span class="comment"># folks who make the GNOME desktop manager and GTK+ libraries).</span>
<a name="l00386"></a>00386 <span class="comment"># GROMACS-X2 requires GLib for its hash table (dictionary).</span>
<a name="l00387"></a>00387 <span class="comment"># </span>
<a name="l00388"></a>00388 <span class="comment"># GLib and FFTW can be compiled from source, but it is much easier if</span>
<a name="l00389"></a>00389 <span class="comment"># you&#39;re using a Linux distribution with a package manager.  If you&#39;re</span>
<a name="l00390"></a>00390 <span class="comment"># running Ubuntu or Debian, run &lt;tt&gt;sudo apt-get install libglib2.0-dev</span>
<a name="l00391"></a>00391 <span class="comment"># libfftw3-dev&lt;/tt&gt;; if you&#39;re using CentOS or some other distro with</span>
<a name="l00392"></a>00392 <span class="comment"># the yum package manager, run &lt;tt&gt;sudo yum install glib2-devel.x86_64</span>
<a name="l00393"></a>00393 <span class="comment"># fftw3-devel.x86_64&lt;/tt&gt; (or replace \c x86_64 with \c i386 if you&#39;re</span>
<a name="l00394"></a>00394 <span class="comment"># not on a 64-bit system.</span>
<a name="l00395"></a>00395 <span class="comment"># </span>
<a name="l00396"></a>00396 <span class="comment"># GROMACS-X2 requires the Intel Math Kernel Library (MKL) for linear algebra.</span>
<a name="l00397"></a>00397 <span class="comment"># In principle this requirement can be lifted if I rewrite the source</span>
<a name="l00398"></a>00398 <span class="comment"># code, but it&#39;s a lot of trouble, plus MKL is faster than other</span>
<a name="l00399"></a>00399 <span class="comment"># implementations of BLAS and LAPACK.</span>
<a name="l00400"></a>00400 <span class="comment"># </span>
<a name="l00401"></a>00401 <span class="comment"># The Intel MKL can be obtained from the Intel website, free of charge</span>
<a name="l00402"></a>00402 <span class="comment"># for noncommercial use.  Currently GROMACS-X2 is built with MKL version</span>
<a name="l00403"></a>00403 <span class="comment"># 10.2, which ships with compiler version 11.1/072 ; this is not the</span>
<a name="l00404"></a>00404 <span class="comment"># newest version, but it can still be obtained from the Intel website</span>
<a name="l00405"></a>00405 <span class="comment"># after you register for a free account.</span>
<a name="l00406"></a>00406 <span class="comment"># </span>
<a name="l00407"></a>00407 <span class="comment"># After installing these packages, extract the tarball that you downloaded</span>
<a name="l00408"></a>00408 <span class="comment"># from the website using the command:</span>
<a name="l00409"></a>00409 <span class="comment"># </span>
<a name="l00410"></a>00410 <span class="comment"># @verbatim tar xvjf gromacs-[version]-x2.tar.bz2 @endverbatim</span>
<a name="l00411"></a>00411 <span class="comment"># </span>
<a name="l00412"></a>00412 <span class="comment"># The directory structure is identical to GROMACS 4.0.7, but I added</span>
<a name="l00413"></a>00413 <span class="comment"># some shell scripts. \c Build.sh will run the configure script using</span>
<a name="l00414"></a>00414 <span class="comment"># some special options, compile the objects, create the executables and</span>
<a name="l00415"></a>00415 <span class="comment"># install them; you will probably need to modify it slightly for your</span>
<a name="l00416"></a>00416 <span class="comment"># environment.  The comments in the script will help further</span>
<a name="l00417"></a>00417 <span class="comment"># with installation.</span>
<a name="l00418"></a>00418 <span class="comment"># </span>
<a name="l00419"></a>00419 <span class="comment"># Don&#39;t forget to specify the install location of the GROMACS-X2 executables</span>
<a name="l00420"></a>00420 <span class="comment"># in the %ForceBalance input file!</span>
<a name="l00421"></a>00421 <span class="comment"># \page usage Usage</span>
<a name="l00422"></a>00422 <span class="comment"># </span>
<a name="l00423"></a>00423 <span class="comment"># This page describes how to use the ForceBalance software.</span>
<a name="l00424"></a>00424 <span class="comment"># </span>
<a name="l00425"></a>00425 <span class="comment"># A good starting point for using this software package is to run the</span>
<a name="l00426"></a>00426 <span class="comment"># scripts contained in the \c bin directory on the example jobs in the</span>
<a name="l00427"></a>00427 <span class="comment"># \c studies directory.</span>
<a name="l00428"></a>00428 <span class="comment"># </span>
<a name="l00429"></a>00429 <span class="comment"># \c ForceBalance.py is the main executable script for force field</span>
<a name="l00430"></a>00430 <span class="comment"># optimization.  It requires an input file and a \ref</span>
<a name="l00431"></a>00431 <span class="comment"># directory_structure.  \c MakeInputFile.py will create an example input</span>
<a name="l00432"></a>00432 <span class="comment"># file containing all options, their default values, and a short</span>
<a name="l00433"></a>00433 <span class="comment"># description for each option.  </span>
<a name="l00434"></a>00434 <span class="comment"># </span>
<a name="l00435"></a>00435 <span class="comment"># @section input_file Input file</span>
<a name="l00436"></a>00436 <span class="comment"># </span>
<a name="l00437"></a>00437 <span class="comment"># A minimal input file for ForceBalance might look something like this:</span>
<a name="l00438"></a>00438 <span class="comment"># </span>
<a name="l00439"></a>00439 <span class="comment"># @verbatim</span>
<a name="l00440"></a>00440 <span class="comment"># </span>
<a name="l00441"></a>00441 <span class="comment"># $options</span>
<a name="l00442"></a>00442 <span class="comment"># jobtype newton</span>
<a name="l00443"></a>00443 <span class="comment"># forcefield water.itp</span>
<a name="l00444"></a>00444 <span class="comment"># $end</span>
<a name="l00445"></a>00445 <span class="comment"># </span>
<a name="l00446"></a>00446 <span class="comment"># $target</span>
<a name="l00447"></a>00447 <span class="comment"># name cluster-02</span>
<a name="l00448"></a>00448 <span class="comment"># type abinitio_gmx</span>
<a name="l00449"></a>00449 <span class="comment"># $end</span>
<a name="l00450"></a>00450 <span class="comment"># </span>
<a name="l00451"></a>00451 <span class="comment"># $target</span>
<a name="l00452"></a>00452 <span class="comment"># name cluster-03</span>
<a name="l00453"></a>00453 <span class="comment"># type abinitio_gmx</span>
<a name="l00454"></a>00454 <span class="comment"># $end</span>
<a name="l00455"></a>00455 <span class="comment"># </span>
<a name="l00456"></a>00456 <span class="comment"># @endverbatim</span>
<a name="l00457"></a>00457 <span class="comment"># </span>
<a name="l00458"></a>00458 <span class="comment"># Global options for a ForceBalance job are given in the \c $options</span>
<a name="l00459"></a>00459 <span class="comment"># section while the settings for each Target are given in</span>
<a name="l00460"></a>00460 <span class="comment"># the \c $target sections.  These are the only two section types.</span>
<a name="l00461"></a>00461 <span class="comment"># </span>
<a name="l00462"></a>00462 <span class="comment"># The most important general options to note are: \c jobtype specifies</span>
<a name="l00463"></a>00463 <span class="comment"># the optimization algorithm to use and \c forcefield specifies the</span>
<a name="l00464"></a>00464 <span class="comment"># force field file name (there may be more than one of these).  The most</span>
<a name="l00465"></a>00465 <span class="comment"># important target options to note are: \c name specifies the target</span>
<a name="l00466"></a>00466 <span class="comment"># name and \c type specifies the type of target (must correspond to a</span>
<a name="l00467"></a>00467 <span class="comment"># subdirectory in \c targets/ ).  All options are explained in the</span>
<a name="l00468"></a>00468 <span class="comment"># Option Index.</span>
<a name="l00469"></a>00469 <span class="comment"># </span>
<a name="l00470"></a>00470 <span class="comment"># @section directory_structure Directory structure</span>
<a name="l00471"></a>00471 <span class="comment"># </span>
<a name="l00472"></a>00472 <span class="comment"># The directory structure for our example job would look like:</span>
<a name="l00473"></a>00473 <span class="comment"># </span>
<a name="l00474"></a>00474 <span class="comment"># @verbatim</span>
<a name="l00475"></a>00475 <span class="comment"># &lt;root&gt;</span>
<a name="l00476"></a>00476 <span class="comment">#   +- forcefield</span>
<a name="l00477"></a>00477 <span class="comment">#   |   |- water.itp</span>
<a name="l00478"></a>00478 <span class="comment">#   +- targets</span>
<a name="l00479"></a>00479 <span class="comment">#   |   +- cluster-02</span>
<a name="l00480"></a>00480 <span class="comment">#   |   |   +- settings (contains job settings)</span>
<a name="l00481"></a>00481 <span class="comment">#   |   |   |   |- shot.mdp</span>
<a name="l00482"></a>00482 <span class="comment">#   |   |   |   |- topol.top</span>
<a name="l00483"></a>00483 <span class="comment">#   |   |   |- all.gro (contains geometries)</span>
<a name="l00484"></a>00484 <span class="comment">#   |   |   |- qdata.txt (contains QM data)</span>
<a name="l00485"></a>00485 <span class="comment">#   |   +- cluster-03</span>
<a name="l00486"></a>00486 <span class="comment">#   |   |   +- settings</span>
<a name="l00487"></a>00487 <span class="comment">#   |   |   |   |- shot.mdp</span>
<a name="l00488"></a>00488 <span class="comment">#   |   |   |   |- topol.top</span>
<a name="l00489"></a>00489 <span class="comment">#   |   |   |- all.gro</span>
<a name="l00490"></a>00490 <span class="comment">#   |   |   |- qdata.txt</span>
<a name="l00491"></a>00491 <span class="comment">#   |   +- &lt;more target directories&gt;</span>
<a name="l00492"></a>00492 <span class="comment">#   |- input.in</span>
<a name="l00493"></a>00493 <span class="comment">#   +- temp</span>
<a name="l00494"></a>00494 <span class="comment">#   |   |- iter_0001</span>
<a name="l00495"></a>00495 <span class="comment">#   |   |- iter_0002</span>
<a name="l00496"></a>00496 <span class="comment">#   |   |   |- &lt;files generated during runtime&gt;</span>
<a name="l00497"></a>00497 <span class="comment">#   +- result</span>
<a name="l00498"></a>00498 <span class="comment">#   |   |- water.itp (Optimized force field, generated on completion)</span>
<a name="l00499"></a>00499 <span class="comment">#   |- input.in (ForceBalance input file)</span>
<a name="l00500"></a>00500 <span class="comment"># @endverbatim</span>
<a name="l00501"></a>00501 <span class="comment"># </span>
<a name="l00502"></a>00502 <span class="comment"># The top-level directory names \b forcefield and \b targets are fixed</span>
<a name="l00503"></a>00503 <span class="comment"># and cannot be changed.  \b forcefield contains the force field files</span>
<a name="l00504"></a>00504 <span class="comment"># that you&#39;re optimizing, and \b targets contains all of the reference</span>
<a name="l00505"></a>00505 <span class="comment"># data as well as the input files for simulating that data using the force</span>
<a name="l00506"></a>00506 <span class="comment"># field.  Each subdirectory in \b targets corresponds to a single</span>
<a name="l00507"></a>00507 <span class="comment"># target, and its contents depend on the specific kind of target and its</span>
<a name="l00508"></a>00508 <span class="comment"># corresponding \c Target class.</span>
<a name="l00509"></a>00509 <span class="comment"># </span>
<a name="l00510"></a>00510 <span class="comment"># The \b temp directory is the temporary workspace of the program, and</span>
<a name="l00511"></a>00511 <span class="comment"># the \b result directory is where the optimized force field files are</span>
<a name="l00512"></a>00512 <span class="comment"># deposited after the optimization job is done.  These two directories</span>
<a name="l00513"></a>00513 <span class="comment"># are created if not already there.</span>
<a name="l00514"></a>00514 <span class="comment"># </span>
<a name="l00515"></a>00515 <span class="comment"># Note the force field file, \c water.itp and the two fitting</span>
<a name="l00516"></a>00516 <span class="comment"># targets \c cluster-02 and \c cluster-03 match the</span>
<a name="l00517"></a>00517 <span class="comment"># \c target sections in the input file.  There are two energy and force matching</span>
<a name="l00518"></a>00518 <span class="comment"># targets here; each directory contains the relevant geometries (in</span>
<a name="l00519"></a>00519 <span class="comment"># \c all.gro ) and reference data (in \c qdata.txt ).</span>
<a name="l00520"></a>00520 <span class="comment"># </span>
<a name="l00521"></a>00521 <span class="comment"># @section targets Setting up the targets</span>
<a name="l00522"></a>00522 <span class="comment"># </span>
<a name="l00523"></a>00523 <span class="comment"># There are many targets one can choose from.</span>
<a name="l00524"></a>00524 <span class="comment"># </span>
<a name="l00525"></a>00525 <span class="comment"># @li Energy and force matching - this is the oldest functionality and the most robust.  Enabled in GROMACS, OpenMM, TINKER, AMBER.</span>
<a name="l00526"></a>00526 <span class="comment"># @li Electrostatic potential fitting via the RESP method.  Enabled in GROMACS and AMBER.</span>
<a name="l00527"></a>00527 <span class="comment"># @li High-performance interaction energies - intended for the same two fragments in many conformations.  Enabled in GROMACS.</span>
<a name="l00528"></a>00528 <span class="comment"># @li General binding energies - intended for highly diverse collections of complexes and fragments.  Enabled in TINKER.</span>
<a name="l00529"></a>00529 <span class="comment"># @li Normal mode frequencies.  Enabled in TINKER.</span>
<a name="l00530"></a>00530 <span class="comment"># @li Condensed-phase properties; currently enabled only for density and enthalpy of vaporization of water.  Enabled in OpenMM.</span>
<a name="l00531"></a>00531 <span class="comment"># @li Basis set coefficient fitting; enabled in psi4 (experimental)</span>
<a name="l00532"></a>00532 <span class="comment"># </span>
<a name="l00533"></a>00533 <span class="comment"># One feature of ForceBalance is that targets can be</span>
<a name="l00534"></a>00534 <span class="comment"># linearly combined to produce an aggregate objective function.  For</span>
<a name="l00535"></a>00535 <span class="comment"># example, our recently developed polarizable water model contains</span>
<a name="l00536"></a>00536 <span class="comment"># energy and force matching, binding energies, normal mode frequencies,</span>
<a name="l00537"></a>00537 <span class="comment"># density, and enthalpy of vaporization.  With the AMOEBA functional</span>
<a name="l00538"></a>00538 <span class="comment"># form and 19 adjustable parameters, we developed a highly accurate</span>
<a name="l00539"></a>00539 <span class="comment"># model that fitted all of these properties to very high accuracy.</span>
<a name="l00540"></a>00540 <span class="comment"># </span>
<a name="l00541"></a>00541 <span class="comment"># Due to the diverse nature of these calculations,</span>
<a name="l00542"></a>00542 <span class="comment"># they need to be set up in a specific way that is recognized by ForceBalance.</span>
<a name="l00543"></a>00543 <span class="comment"># The setup is different for each type of simulation, and we invite</span>
<a name="l00544"></a>00544 <span class="comment"># you to learn by example through looking at the files in the \c studies</span>
<a name="l00545"></a>00545 <span class="comment"># directory.</span>
<a name="l00546"></a>00546 <span class="comment"># </span>
<a name="l00547"></a>00547 <span class="comment"># @subsection energy_force_matching Energy and force matching</span>
<a name="l00548"></a>00548 <span class="comment"># </span>
<a name="l00549"></a>00549 <span class="comment"># In these relatively simple simulations, the objective function is</span>
<a name="l00550"></a>00550 <span class="comment"># computed from the squared difference in the potential energy and</span>
<a name="l00551"></a>00551 <span class="comment"># forces (gradients) between the force field and reference (QM) method,</span>
<a name="l00552"></a>00552 <span class="comment"># evaluated at a number of stored geometries called &lt;em&gt;snapshots&lt;/em&gt;.</span>
<a name="l00553"></a>00553 <span class="comment"># The mathematics are implemented in \c abinitio.py while the interfaces</span>
<a name="l00554"></a>00554 <span class="comment"># to simulation software exist in derived classes in \c gmxio.py, \c</span>
<a name="l00555"></a>00555 <span class="comment"># tinkerio.py, \c amberio.py and \c openmmio.py.</span>
<a name="l00556"></a>00556 <span class="comment"># </span>
<a name="l00557"></a>00557 <span class="comment"># All energy and force matching targets require a &lt;em&gt;coordinate</span>
<a name="l00558"></a>00558 <span class="comment"># trajectory file&lt;/em&gt; (\c all.gro ) and a &lt;em&gt; quantum data file &lt;/em&gt;</span>
<a name="l00559"></a>00559 <span class="comment"># (\c qdata.txt ).  The coordinate trajectory file contains the</span>
<a name="l00560"></a>00560 <span class="comment"># Cartesian coordinates of the snapshots, preferably in the file format</span>
<a name="l00561"></a>00561 <span class="comment"># of the simulation software used (\c all.gro is the most extensively</span>
<a name="l00562"></a>00562 <span class="comment"># tested.)  The quantum data file is formatted according to a very</span>
<a name="l00563"></a>00563 <span class="comment"># simple specification:</span>
<a name="l00564"></a>00564 <span class="comment"># </span>
<a name="l00565"></a>00565 <span class="comment"># @verbatim</span>
<a name="l00566"></a>00566 <span class="comment"># JOB 0</span>
<a name="l00567"></a>00567 <span class="comment"># COORDS x1 y1 z1 x2 y2 z2 ... (floating point numbers in Angstrom)</span>
<a name="l00568"></a>00568 <span class="comment"># ENERGY (floating point number in Hartree)</span>
<a name="l00569"></a>00569 <span class="comment"># FORCES fx1 fy1 fz1 ... (floating point numbers in Hartree/bohr - this is a misnomer because they are actually gradients, which differ by a sign from the forces.)</span>
<a name="l00570"></a>00570 <span class="comment"># </span>
<a name="l00571"></a>00571 <span class="comment"># JOB 1</span>
<a name="l00572"></a>00572 <span class="comment"># ...</span>
<a name="l00573"></a>00573 <span class="comment"># @endverbatim</span>
<a name="l00574"></a>00574 <span class="comment"># </span>
<a name="l00575"></a>00575 <span class="comment"># The coordinates in the quantum data file should be consistent with the</span>
<a name="l00576"></a>00576 <span class="comment"># coordinate trajectory file, although ForceBalance will use the latter</span>
<a name="l00577"></a>00577 <span class="comment"># most of the time.  It is easy to generate the quantum data file from</span>
<a name="l00578"></a>00578 <span class="comment"># parsing the output of quantum chemistry software.  ForceBalance</span>
<a name="l00579"></a>00579 <span class="comment"># contains methods for parsing Q-Chem output files in the \c molecule.py class.</span>
<a name="l00580"></a>00580 <span class="comment"># </span>
<a name="l00581"></a>00581 <span class="comment"># In addition to \c all.gro and \c qdata.txt , the simulation setup</span>
<a name="l00582"></a>00582 <span class="comment"># files are required.  These contain settings needed by the simulation</span>
<a name="l00583"></a>00583 <span class="comment"># software for the calculation to run.  For Gromacs calculations, a</span>
<a name="l00584"></a>00584 <span class="comment"># topology (.top) file and a run parameter file (.mdp) are required.</span>
<a name="l00585"></a>00585 <span class="comment"># These should be placed in the \c settings subdirectory within the</span>
<a name="l00586"></a>00586 <span class="comment"># directory belonging to the target.</span>
<a name="l00587"></a>00587 <span class="comment"># </span>
<a name="l00588"></a>00588 <span class="comment"># As a side note: If you wish to tune a number in the .mdp file, simply</span>
<a name="l00589"></a>00589 <span class="comment"># move it to the \c forcefield directory and specify it as a force field</span>
<a name="l00590"></a>00590 <span class="comment"># file.  ForceBalance will now be able to tune any highlighted</span>
<a name="l00591"></a>00591 <span class="comment"># parameters in the file, although it will also place copies of this</span>
<a name="l00592"></a>00592 <span class="comment"># file in all target directories within \c temp while the program is</span>
<a name="l00593"></a>00593 <span class="comment"># running.</span>
<a name="l00594"></a>00594 <span class="comment"># </span>
<a name="l00595"></a>00595 <span class="comment"># @subsection Electrostatic potentials</span>
<a name="l00596"></a>00596 <span class="comment"># </span>
<a name="l00597"></a>00597 <span class="comment"># ForceBalance contains methods for evaluating electrostatic potentials</span>
<a name="l00598"></a>00598 <span class="comment"># given a collection of point charges.  At this time, this functionality</span>
<a name="l00599"></a>00599 <span class="comment"># is very experimental and risky to use for systems containing more than</span>
<a name="l00600"></a>00600 <span class="comment"># one molecule.  This is because ForceBalance evaluates the</span>
<a name="l00601"></a>00601 <span class="comment"># electrostatic potentials internally, and we don&#39;t have an</span>
<a name="l00602"></a>00602 <span class="comment"># infrastructure for building a full topology consisting of many</span>
<a name="l00603"></a>00603 <span class="comment"># molecules.  Currently, we assume that the electrostatic potential</span>
<a name="l00604"></a>00604 <span class="comment"># fitting contains only one molecule.</span>
<a name="l00605"></a>00605 <span class="comment"># </span>
<a name="l00606"></a>00606 <span class="comment"># Once again, the coordinate trajectory file and quantum data files are</span>
<a name="l00607"></a>00607 <span class="comment"># used to specify the calculation.  However, now the coordinates for</span>
<a name="l00608"></a>00608 <span class="comment"># evaluating the potential, and the reference potential values, are</span>
<a name="l00609"></a>00609 <span class="comment"># included:</span>
<a name="l00610"></a>00610 <span class="comment"># </span>
<a name="l00611"></a>00611 <span class="comment"># @verbatim</span>
<a name="l00612"></a>00612 <span class="comment"># JOB 0</span>
<a name="l00613"></a>00613 <span class="comment"># COORDS x1 y1 z1 x2 y2 z2 ...</span>
<a name="l00614"></a>00614 <span class="comment"># ENERGY e</span>
<a name="l00615"></a>00615 <span class="comment"># FORCES fx1 fy1 fz1 ...</span>
<a name="l00616"></a>00616 <span class="comment"># ESPXYZ ex1 ey1 ez1 ex2 ey2 ez2 ... </span>
<a name="l00617"></a>00617 <span class="comment"># ESPVAL ev1 ev2 ev3 ..</span>
<a name="l00618"></a>00618 <span class="comment"># @endverbatim</span>
<a name="l00619"></a>00619 <span class="comment"># </span>
<a name="l00620"></a>00620 <span class="comment"># @section running_software Running the optimization</span>
<a name="l00621"></a>00621 <span class="comment"># </span>
<a name="l00622"></a>00622 <span class="comment"># To run ForceBalance, make sure the calculation is set up properly</span>
<a name="l00623"></a>00623 <span class="comment"># (refer to the above sections), and then type in:</span>
<a name="l00624"></a>00624 <span class="comment"># </span>
<a name="l00625"></a>00625 <span class="comment"># &lt;b&gt; ForceBalance.py input.in &lt;/b&gt;</span>
<a name="l00626"></a>00626 <span class="comment"># </span>
<a name="l00627"></a>00627 <span class="comment"># In general it&#39;s impossible to set up a calculation perfectly the first</span>
<a name="l00628"></a>00628 <span class="comment"># time, in which case the calculation will crash.  ForceBalance will try</span>
<a name="l00629"></a>00629 <span class="comment"># to print helpful error messages to guide you toward setting up your</span>
<a name="l00630"></a>00630 <span class="comment"># calculation properly.</span>
<a name="l00631"></a>00631 <span class="comment"># </span>
<a name="l00632"></a>00632 <span class="comment"># Further example inputs and outputs are given in the Tutorial section.</span>
<a name="l00633"></a>00633 <span class="comment"># \page tutorial Tutorial</span>
<a name="l00634"></a>00634 <span class="comment"># </span>
<a name="l00635"></a>00635 <span class="comment"># This is a tutorial page, but if you haven&#39;t installed ForceBalance yet</span>
<a name="l00636"></a>00636 <span class="comment"># please go to the Installation page first.  It is very much in process,</span>
<a name="l00637"></a>00637 <span class="comment"># and there are many more examples to come.</span>
<a name="l00638"></a>00638 <span class="comment"># </span>
<a name="l00639"></a>00639 <span class="comment"># \section tip4p Fitting a TIP4P potential to QM cluster calculations</span>
<a name="l00640"></a>00640 <span class="comment"># </span>
<a name="l00641"></a>00641 <span class="comment"># After everything is installed, go to the \c studies/001_water_tutorial directory in the distribution.</span>
<a name="l00642"></a>00642 <span class="comment"># Extract the \c targets.tar.bz2 archive file.  Now execute:</span>
<a name="l00643"></a>00643 <span class="comment"># </span>
<a name="l00644"></a>00644 <span class="comment"># @verbatim</span>
<a name="l00645"></a>00645 <span class="comment"># ForceBalance.py very_simple.in</span>
<a name="l00646"></a>00646 <span class="comment"># @endverbatim</span>
<a name="l00647"></a>00647 <span class="comment"># </span>
<a name="l00648"></a>00648 <span class="comment"># If the installation was successful, you will get an output file</span>
<a name="l00649"></a>00649 <span class="comment"># similar to \c very_simple.out .  What follows is a description</span>
<a name="l00650"></a>00650 <span class="comment"># of the output file and what ForceBalance is actually doing.</span>
<a name="l00651"></a>00651 <span class="comment"># </span>
<a name="l00652"></a>00652 <span class="comment"># ForceBalance begins by reading the force field files from the \c</span>
<a name="l00653"></a>00653 <span class="comment"># forcefield directory.  The parameters to be optimized are specified in</span>
<a name="l00654"></a>00654 <span class="comment"># the parameter file by adding a special comment inside the file.  For</span>
<a name="l00655"></a>00655 <span class="comment"># example, in the \c water.itp file, we specify that the two van der</span>
<a name="l00656"></a>00656 <span class="comment"># Waals parameters on oxygen are to be optimized, using the following</span>
<a name="l00657"></a>00657 <span class="comment"># syntax:</span>
<a name="l00658"></a>00658 <span class="comment"># </span>
<a name="l00659"></a>00659 <span class="comment"># @verbatim</span>
<a name="l00660"></a>00660 <span class="comment"># OW    8     15.99940     0.000       A    3.15365e-01  6.48520e-01 ; PARM 5 6</span>
<a name="l00661"></a>00661 <span class="comment"># @endverbatim</span>
<a name="l00662"></a>00662 <span class="comment"># </span>
<a name="l00663"></a>00663 <span class="comment"># The comment &lt;tt&gt;PARM 5 6&lt;/tt&gt; signals that &quot;the parameters in fields 5</span>
<a name="l00664"></a>00664 <span class="comment"># and 6 are to be optimized.&quot;  The force field parser stores the</span>
<a name="l00665"></a>00665 <span class="comment"># physical value of the parameter and gives the parameter a name.  These</span>
<a name="l00666"></a>00666 <span class="comment"># are printed out in the output file:</span>
<a name="l00667"></a>00667 <span class="comment"># </span>
<a name="l00668"></a>00668 <span class="comment"># @verbatim</span>
<a name="l00669"></a>00669 <span class="comment"># Reading force field from file: water.itp</span>
<a name="l00670"></a>00670 <span class="comment"># </span>
<a name="l00671"></a>00671 <span class="comment"># ###########################################################</span>
<a name="l00672"></a>00672 <span class="comment"># ### Starting parameter indices, physical values and IDs ###</span>
<a name="l00673"></a>00673 <span class="comment"># ###########################################################</span>
<a name="l00674"></a>00674 <span class="comment">#    0 [  3.1537e-01 ] : VDWS:OW</span>
<a name="l00675"></a>00675 <span class="comment">#    1 [  6.4852e-01 ] : VDWT:OW</span>
<a name="l00676"></a>00676 <span class="comment">#    2 [  9.5720e-02 ] : BONDSB:HWOW</span>
<a name="l00677"></a>00677 <span class="comment">#    3 [  5.0242e+05 ] : BONDSK:HWOW</span>
<a name="l00678"></a>00678 <span class="comment">#    4 [  1.0452e+02 ] : ANGLESB:HWOWHW</span>
<a name="l00679"></a>00679 <span class="comment">#    5 [  6.2802e+02 ] : ANGLESK:HWOWHW</span>
<a name="l00680"></a>00680 <span class="comment">#    6 [  5.2000e-01 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00681"></a>00681 <span class="comment">#    7 [ -1.0400e+00 ] : COUL:SOL-4</span>
<a name="l00682"></a>00682 <span class="comment">#    8 [  1.2800e-01 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00683"></a>00683 <span class="comment"># -----------------------------------------------------------</span>
<a name="l00684"></a>00684 <span class="comment"># @endverbatim</span>
<a name="l00685"></a>00685 <span class="comment"># </span>
<a name="l00686"></a>00686 <span class="comment"># The next section it prints out are a set of rescaling factors which are</span>
<a name="l00687"></a>00687 <span class="comment"># important for various aspects of the optimization.  They are discussed</span>
<a name="l00688"></a>00688 <span class="comment"># further in this &lt;a href=https://simtk.org/forums/viewtopic.php?f=710&amp;t=3827&gt;forum post&lt;/a&gt;.</span>
<a name="l00689"></a>00689 <span class="comment"># For now it suffices to say that these values represent the natural size of the parameter,</span>
<a name="l00690"></a>00690 <span class="comment"># or more specifically how much the parameter is expected to vary.</span>
<a name="l00691"></a>00691 <span class="comment"># </span>
<a name="l00692"></a>00692 <span class="comment"># @verbatim</span>
<a name="l00693"></a>00693 <span class="comment"># ##########################################################</span>
<a name="l00694"></a>00694 <span class="comment"># ###    Rescaling Factors (Lower Takes Precedence):     ###</span>
<a name="l00695"></a>00695 <span class="comment"># ##########################################################</span>
<a name="l00696"></a>00696 <span class="comment">#    BONDSB                               : 5.29177e-02</span>
<a name="l00697"></a>00697 <span class="comment">#    BONDSK                               : 9.37583e+05</span>
<a name="l00698"></a>00698 <span class="comment">#    VSITE3A                              : 5.29177e-02</span>
<a name="l00699"></a>00699 <span class="comment">#    VSITE3B                              : 5.29177e-02</span>
<a name="l00700"></a>00700 <span class="comment">#    ANGLESB                              : 5.72958e+01</span>
<a name="l00701"></a>00701 <span class="comment">#    VDWS                                 : 5.29177e-02</span>
<a name="l00702"></a>00702 <span class="comment">#    ANGLESK                              : 6.05928e+02</span>
<a name="l00703"></a>00703 <span class="comment">#    COUL                                 : 1.00000e+00</span>
<a name="l00704"></a>00704 <span class="comment">#    VDWT                                 : 2.47894e+00</span>
<a name="l00705"></a>00705 <span class="comment"># ----------------------------------------------------------</span>
<a name="l00706"></a>00706 <span class="comment"># @endverbatim</span>
<a name="l00707"></a>00707 <span class="comment"># </span>
<a name="l00708"></a>00708 <span class="comment"># Next, it prints out user-specified options that pertain to the force</span>
<a name="l00709"></a>00709 <span class="comment"># field the targets, the objective function and the optimizer.  Options</span>
<a name="l00710"></a>00710 <span class="comment"># that are left at their default values (in this case, most) are not</span>
<a name="l00711"></a>00711 <span class="comment"># printed out.  Use &lt;tt&gt;verbose_options True&lt;/tt&gt; in the input file to</span>
<a name="l00712"></a>00712 <span class="comment"># print out all of the options.</span>
<a name="l00713"></a>00713 <span class="comment"># </span>
<a name="l00714"></a>00714 <span class="comment"># Now for the good stuff - the optimizer begins.  ForceBalance computes</span>
<a name="l00715"></a>00715 <span class="comment"># each target and prints out an indicator for each one, then provides</span>
<a name="l00716"></a>00716 <span class="comment"># a breakdown of the overall objective function:</span>
<a name="l00717"></a>00717 <span class="comment"># </span>
<a name="l00718"></a>00718 <span class="comment"># @verbatim</span>
<a name="l00719"></a>00719 <span class="comment"># ##########################################################</span>
<a name="l00720"></a>00720 <span class="comment"># ###                   Main Optimizer                   ###</span>
<a name="l00721"></a>00721 <span class="comment"># ###       Newton-Raphson Mode (Adaptive Radius)        ###</span>
<a name="l00722"></a>00722 <span class="comment"># ##########################################################</span>
<a name="l00723"></a>00723 <span class="comment"># </span>
<a name="l00724"></a>00724 <span class="comment"># Target: cluster-06      Errors: Energy =   9.4124 kJ/mol (34.4605%) Atomic Force (%) =  32.4778 Objective = 1.12062e-01</span>
<a name="l00725"></a>00725 <span class="comment"># Target: cluster-12      Errors: Energy =  15.2291 kJ/mol (32.1658%) Atomic Force (%) =  32.3608 Objective = 1.04094e-01</span>
<a name="l00726"></a>00726 <span class="comment"># </span>
<a name="l00727"></a>00727 <span class="comment"># ######################################################################</span>
<a name="l00728"></a>00728 <span class="comment"># ###                  Objective Function Breakdown                  ###</span>
<a name="l00729"></a>00729 <span class="comment"># ###  Target Name              Residual  x  Weight  =  Contribution ###</span>
<a name="l00730"></a>00730 <span class="comment"># ######################################################################</span>
<a name="l00731"></a>00731 <span class="comment"># cluster-06                     0.11206      0.500      5.60309e-02 </span>
<a name="l00732"></a>00732 <span class="comment"># cluster-12                     0.10409      0.500      5.20472e-02 </span>
<a name="l00733"></a>00733 <span class="comment"># Regularization                 0.00000      1.000      0.00000e+00 </span>
<a name="l00734"></a>00734 <span class="comment"># Total                                                  1.08078e-01 </span>
<a name="l00735"></a>00735 <span class="comment"># ----------------------------------------------------------------------</span>
<a name="l00736"></a>00736 <span class="comment">#   Step       |k|        |dk|       |grad|       -=X2=-     Stdev(X2)    StepQual</span>
<a name="l00737"></a>00737 <span class="comment">#      0   0.000e+00   0.000e+00   3.202e+00   1.08078e-01   0.000e+00      1.000</span>
<a name="l00738"></a>00738 <span class="comment"># @endverbatim</span>
<a name="l00739"></a>00739 <span class="comment"># </span>
<a name="l00740"></a>00740 <span class="comment"># In this example job, the targets were QM energies and forces for</span>
<a name="l00741"></a>00741 <span class="comment"># clusters of 6 and 12 water molecules.  In the initial step (using the</span>
<a name="l00742"></a>00742 <span class="comment"># default TIP4P parameters) and for the first target (6-mers), the RMS</span>
<a name="l00743"></a>00743 <span class="comment"># error for energies is 9.4124 kJ/mol (34% of the variance in the QM</span>
<a name="l00744"></a>00744 <span class="comment"># energies themselves), and the RMS error for atomistic forces is 32%</span>
<a name="l00745"></a>00745 <span class="comment"># (again, scaled to the variance of the QM forces).  Similar</span>
<a name="l00746"></a>00746 <span class="comment"># information is printed out for the 12-mers.  Each target contributes</span>
<a name="l00747"></a>00747 <span class="comment"># to the overall objective function, whose value is 1.080e-01.  The</span>
<a name="l00748"></a>00748 <span class="comment"># parameters are at their initial values, which means that any penalty</span>
<a name="l00749"></a>00749 <span class="comment"># function will have a value of zero (the Regularization term).</span>
<a name="l00750"></a>00750 <span class="comment"># </span>
<a name="l00751"></a>00751 <span class="comment"># Next, ForceBalance takes a step in the parameter space.  The default</span>
<a name="l00752"></a>00752 <span class="comment"># algorithm (a variation of Newton-Raphson) uses first and second</span>
<a name="l00753"></a>00753 <span class="comment"># derivative information; the gradient is printed to the screen, as is</span>
<a name="l00754"></a>00754 <span class="comment"># the parameter step.</span>
<a name="l00755"></a>00755 <span class="comment"># </span>
<a name="l00756"></a>00756 <span class="comment"># @verbatim</span>
<a name="l00757"></a>00757 <span class="comment"># ##########################################################</span>
<a name="l00758"></a>00758 <span class="comment"># ###                   Total Gradient                   ###</span>
<a name="l00759"></a>00759 <span class="comment"># ##########################################################</span>
<a name="l00760"></a>00760 <span class="comment">#    0 [ -1.3660e-01 ] : VDWS:OW</span>
<a name="l00761"></a>00761 <span class="comment">#    1 [ -2.2433e-01 ] : VDWT:OW</span>
<a name="l00762"></a>00762 <span class="comment">#    2 [ -3.1494e+00 ] : BONDSB:HWOW</span>
<a name="l00763"></a>00763 <span class="comment">#    3 [  3.5524e-01 ] : BONDSK:HWOW</span>
<a name="l00764"></a>00764 <span class="comment">#    4 [ -3.2448e-01 ] : ANGLESB:HWOWHW</span>
<a name="l00765"></a>00765 <span class="comment">#    5 [  8.9350e-02 ] : ANGLESK:HWOWHW</span>
<a name="l00766"></a>00766 <span class="comment">#    6 [  0.0000e+00 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00767"></a>00767 <span class="comment">#    7 [ -1.6540e-01 ] : COUL:SOL-4</span>
<a name="l00768"></a>00768 <span class="comment">#    8 [ -2.2355e-02 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00769"></a>00769 <span class="comment"># ----------------------------------------------------------</span>
<a name="l00770"></a>00770 <span class="comment"># </span>
<a name="l00771"></a>00771 <span class="comment"># Levenberg-Marquardt: Newton-Raphson step found (length 1.000e-01), Hessian diagonal is scaled by  4.394</span>
<a name="l00772"></a>00772 <span class="comment"># </span>
<a name="l00773"></a>00773 <span class="comment"># ##########################################################</span>
<a name="l00774"></a>00774 <span class="comment"># ###  Mathematical Parameters (Current + Step = Next)   ###</span>
<a name="l00775"></a>00775 <span class="comment"># ##########################################################</span>
<a name="l00776"></a>00776 <span class="comment">#    0 [  0.0000e+00 + 2.1358e-02 =  2.1358e-02 ] : VDWS:OW</span>
<a name="l00777"></a>00777 <span class="comment">#    1 [  0.0000e+00 + 1.3608e-02 =  1.3608e-02 ] : VDWT:OW</span>
<a name="l00778"></a>00778 <span class="comment">#    2 [  0.0000e+00 + 1.3185e-03 =  1.3185e-03 ] : BONDSB:HWOW</span>
<a name="l00779"></a>00779 <span class="comment">#    3 [  0.0000e+00 - 1.4385e-02 = -1.4385e-02 ] : BONDSK:HWOW</span>
<a name="l00780"></a>00780 <span class="comment">#    4 [  0.0000e+00 + 1.3960e-03 =  1.3960e-03 ] : ANGLESB:HWOWHW</span>
<a name="l00781"></a>00781 <span class="comment">#    5 [  0.0000e+00 - 8.6541e-02 = -8.6541e-02 ] : ANGLESK:HWOWHW</span>
<a name="l00782"></a>00782 <span class="comment">#    6 [  0.0000e+00 + 0.0000e+00 =  0.0000e+00 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00783"></a>00783 <span class="comment">#    7 [  0.0000e+00 + 5.9651e-03 =  5.9651e-03 ] : COUL:SOL-4</span>
<a name="l00784"></a>00784 <span class="comment">#    8 [  0.0000e+00 + 4.0295e-02 =  4.0295e-02 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00785"></a>00785 <span class="comment"># ----------------------------------------------------------</span>
<a name="l00786"></a>00786 <span class="comment"># </span>
<a name="l00787"></a>00787 <span class="comment"># ##########################################################</span>
<a name="l00788"></a>00788 <span class="comment"># ###    Physical Parameters (Current + Step = Next)     ###</span>
<a name="l00789"></a>00789 <span class="comment"># ##########################################################</span>
<a name="l00790"></a>00790 <span class="comment">#    0 [  3.1537e-01 + 1.1302e-03 =  3.1650e-01 ] : VDWS:OW</span>
<a name="l00791"></a>00791 <span class="comment">#    1 [  6.4852e-01 + 3.3734e-02 =  6.8225e-01 ] : VDWT:OW</span>
<a name="l00792"></a>00792 <span class="comment">#    2 [  9.5720e-02 + 6.9774e-05 =  9.5790e-02 ] : BONDSB:HWOW</span>
<a name="l00793"></a>00793 <span class="comment">#    3 [  5.0242e+05 - 1.3487e+04 =  4.8893e+05 ] : BONDSK:HWOW</span>
<a name="l00794"></a>00794 <span class="comment">#    4 [  1.0452e+02 + 7.9985e-02 =  1.0460e+02 ] : ANGLESB:HWOWHW</span>
<a name="l00795"></a>00795 <span class="comment">#    5 [  6.2802e+02 - 5.2438e+01 =  5.7558e+02 ] : ANGLESK:HWOWHW</span>
<a name="l00796"></a>00796 <span class="comment">#    6 [  5.2000e-01 - 2.3860e-03 =  5.1761e-01 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00797"></a>00797 <span class="comment">#    7 [ -1.0400e+00 + 4.7721e-03 = -1.0352e+00 ] : COUL:SOL-4</span>
<a name="l00798"></a>00798 <span class="comment">#    8 [  1.2800e-01 + 2.1323e-03 =  1.3013e-01 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00799"></a>00799 <span class="comment"># ----------------------------------------------------------</span>
<a name="l00800"></a>00800 <span class="comment"># @endverbatim</span>
<a name="l00801"></a>00801 <span class="comment"># </span>
<a name="l00802"></a>00802 <span class="comment"># Note that the step length is limited to a &quot;trust radius&quot; of 0.1 - this</span>
<a name="l00803"></a>00803 <span class="comment"># option is tunable.  The step in parameter space is given in terms of</span>
<a name="l00804"></a>00804 <span class="comment"># the &quot;mathematical parameters&quot; - the internal optimization variables -</span>
<a name="l00805"></a>00805 <span class="comment"># and the &quot;physical parameters&quot; which are the actual values in the force</span>
<a name="l00806"></a>00806 <span class="comment"># field files.  The mathematical parameters are mainly useful because</span>
<a name="l00807"></a>00807 <span class="comment"># they can be used to restart an optimization by creating a \c</span>
<a name="l00808"></a>00808 <span class="comment"># read_mvals section to the input file and pasting the lines from the output.</span>
<a name="l00809"></a>00809 <span class="comment"># </span>
<a name="l00810"></a>00810 <span class="comment"># ForceBalance now computes the objective function again, using the new parameter values.</span>
<a name="l00811"></a>00811 <span class="comment"># </span>
<a name="l00812"></a>00812 <span class="comment"># @verbatim</span>
<a name="l00813"></a>00813 <span class="comment"># Target: cluster-06      Errors: Energy =   8.6451 kJ/mol (31.6513%) Atomic Force (%) =  28.1040 Objective = 8.95353e-02</span>
<a name="l00814"></a>00814 <span class="comment"># Target: cluster-12      Errors: Energy =  14.0941 kJ/mol (29.7686%) Atomic Force (%) =  28.1275 Objective = 8.38673e-02</span>
<a name="l00815"></a>00815 <span class="comment"># </span>
<a name="l00816"></a>00816 <span class="comment"># #####################################################################################</span>
<a name="l00817"></a>00817 <span class="comment"># ###                         Objective Function Breakdown                          ###</span>
<a name="l00818"></a>00818 <span class="comment"># ###  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) ###</span>
<a name="l00819"></a>00819 <span class="comment"># #####################################################################################</span>
<a name="l00820"></a>00820 <span class="comment"># cluster-06                     0.08954      0.500      4.47677e-02 ( -1.126e-02 ) </span>
<a name="l00821"></a>00821 <span class="comment"># cluster-12                     0.08387      0.500      4.19337e-02 ( -1.011e-02 ) </span>
<a name="l00822"></a>00822 <span class="comment"># Regularization                 0.00010      1.000      1.00006e-04 ( +1.000e-04 ) </span>
<a name="l00823"></a>00823 <span class="comment"># Total                                                  8.68013e-02 ( -2.128e-02 ) </span>
<a name="l00824"></a>00824 <span class="comment"># -------------------------------------------------------------------------------------</span>
<a name="l00825"></a>00825 <span class="comment">#   Step       |k|        |dk|       |grad|       -=X2=-     Stdev(X2)    StepQual</span>
<a name="l00826"></a>00826 <span class="comment">#      1   1.000e-01   1.000e-01   2.281e+00   8.68013e-02   1.064e-02      1.000</span>
<a name="l00827"></a>00827 <span class="comment"># @endverbatim</span>
<a name="l00828"></a>00828 <span class="comment"># </span>
<a name="l00829"></a>00829 <span class="comment"># Using the new parameter values, the values for each target have gone</span>
<a name="l00830"></a>00830 <span class="comment"># down - that is to say, the force field now produces better agreement</span>
<a name="l00831"></a>00831 <span class="comment"># with the reference data.  In the objective function breakdown,</span>
<a name="l00832"></a>00832 <span class="comment"># improvements (i.e. decreasing values) from the previous step are</span>
<a name="l00833"></a>00833 <span class="comment"># printed in green while increasing values are printed in red.  The</span>
<a name="l00834"></a>00834 <span class="comment"># &quot;Regularization&quot; term is printed in red because the parameters have</span>
<a name="l00835"></a>00835 <span class="comment"># moved from their initial values, so the penalty function is now finite.</span>
<a name="l00836"></a>00836 <span class="comment"># </span>
<a name="l00837"></a>00837 <span class="comment"># The last line reports:</span>
<a name="l00838"></a>00838 <span class="comment"># </span>
<a name="l00839"></a>00839 <span class="comment"># @li The step number (&lt;tt&gt;Step&lt;/tt&gt;)</span>
<a name="l00840"></a>00840 <span class="comment"># @li The length of the parameter vector in the mathematical parameter space (&lt;tt&gt;|k|&lt;/tt&gt;)</span>
<a name="l00841"></a>00841 <span class="comment"># @li The length of the most recent step (&lt;tt&gt;|dk|&lt;/tt&gt;)</span>
<a name="l00842"></a>00842 <span class="comment"># @li The magnitude of the objective function gradient vector (&lt;tt&gt;|grad|&lt;/tt&gt;)</span>
<a name="l00843"></a>00843 <span class="comment"># @li The objective function value (&lt;tt&gt;-=X2=-&lt;/tt&gt;)</span>
<a name="l00844"></a>00844 <span class="comment"># @li The standard deviation of the objective function over a user-specified number of optimization steps</span>
<a name="l00845"></a>00845 <span class="comment"># @li The ratio of actual-to-predicted change in the objective function value.  A &lt;tt&gt;StepQual&lt;/tt&gt; value of 1.0 signifies that the trust radius can be increased.</span>
<a name="l00846"></a>00846 <span class="comment"># </span>
<a name="l00847"></a>00847 <span class="comment"># Eventually, the optimization will converge.  For this job (and when this documentation was written) it took seven steps:</span>
<a name="l00848"></a>00848 <span class="comment"># </span>
<a name="l00849"></a>00849 <span class="comment"># @verbatim</span>
<a name="l00850"></a>00850 <span class="comment"># Target: cluster-06      Errors: Energy =   8.0790 kJ/mol (29.5789%) Atomic Force (%) =  20.9879 Objective = 6.57373e-02</span>
<a name="l00851"></a>00851 <span class="comment"># Target: cluster-12      Errors: Energy =  13.1380 kJ/mol (27.7491%) Atomic Force (%) =  21.2594 Objective = 6.10941e-02</span>
<a name="l00852"></a>00852 <span class="comment"># </span>
<a name="l00853"></a>00853 <span class="comment"># #####################################################################################</span>
<a name="l00854"></a>00854 <span class="comment"># ###                         Objective Function Breakdown                          ###</span>
<a name="l00855"></a>00855 <span class="comment"># ###  Target Name              Residual  x  Weight  =  Contribution (Current-Prev) ###</span>
<a name="l00856"></a>00856 <span class="comment"># #####################################################################################</span>
<a name="l00857"></a>00857 <span class="comment"># cluster-06                     0.06574      0.500      3.28686e-02 ( -2.182e-05 ) </span>
<a name="l00858"></a>00858 <span class="comment"># cluster-12                     0.06109      0.500      3.05470e-02 ( -7.147e-05 ) </span>
<a name="l00859"></a>00859 <span class="comment"># Regularization                 0.00148      1.000      1.48377e-03 ( +4.758e-05 ) </span>
<a name="l00860"></a>00860 <span class="comment"># Total                                                  6.48994e-02 ( -4.570e-05 ) </span>
<a name="l00861"></a>00861 <span class="comment"># -------------------------------------------------------------------------------------</span>
<a name="l00862"></a>00862 <span class="comment">#   Step       |k|        |dk|       |grad|       -=X2=-     Stdev(X2)    StepQual</span>
<a name="l00863"></a>00863 <span class="comment">#      7   3.852e-01   6.595e-03   4.920e-02   6.48994e-02   7.165e-05      0.996</span>
<a name="l00864"></a>00864 <span class="comment"># </span>
<a name="l00865"></a>00865 <span class="comment"># Convergence criterion reached for objective function (1.00e-04)</span>
<a name="l00866"></a>00866 <span class="comment"># </span>
<a name="l00867"></a>00867 <span class="comment"># @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span>
<a name="l00868"></a>00868 <span class="comment"># @@@           Final objective function value           @@@</span>
<a name="l00869"></a>00869 <span class="comment"># @@@  Full:  6.489943e-02  Un-penalized:  6.341566e-02  @@@</span>
<a name="l00870"></a>00870 <span class="comment"># @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span>
<a name="l00871"></a>00871 <span class="comment"># </span>
<a name="l00872"></a>00872 <span class="comment"># ##########################################################</span>
<a name="l00873"></a>00873 <span class="comment"># ###           Final optimization parameters:           ###</span>
<a name="l00874"></a>00874 <span class="comment"># ###           Paste to input file to restart           ###</span>
<a name="l00875"></a>00875 <span class="comment"># ##########################################################</span>
<a name="l00876"></a>00876 <span class="comment"># read_mvals</span>
<a name="l00877"></a>00877 <span class="comment">#    0 [  4.1767e-02 ] : VDWS:OW</span>
<a name="l00878"></a>00878 <span class="comment">#    1 [  3.1400e-02 ] : VDWT:OW</span>
<a name="l00879"></a>00879 <span class="comment">#    2 [  5.3170e-03 ] : BONDSB:HWOW</span>
<a name="l00880"></a>00880 <span class="comment">#    3 [ -4.6558e-02 ] : BONDSK:HWOW</span>
<a name="l00881"></a>00881 <span class="comment">#    4 [  1.4927e-02 ] : ANGLESB:HWOWHW</span>
<a name="l00882"></a>00882 <span class="comment">#    5 [ -3.6741e-01 ] : ANGLESK:HWOWHW</span>
<a name="l00883"></a>00883 <span class="comment">#    6 [  0.0000e+00 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00884"></a>00884 <span class="comment">#    7 [  9.4636e-03 ] : COUL:SOL-4</span>
<a name="l00885"></a>00885 <span class="comment">#    8 [  9.0280e-02 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00886"></a>00886 <span class="comment"># /read_mvals</span>
<a name="l00887"></a>00887 <span class="comment"># </span>
<a name="l00888"></a>00888 <span class="comment"># ##########################################################</span>
<a name="l00889"></a>00889 <span class="comment"># ###             Final physical parameters:             ###</span>
<a name="l00890"></a>00890 <span class="comment"># ##########################################################</span>
<a name="l00891"></a>00891 <span class="comment">#    0 [  3.1758e-01 ] : VDWS:OW</span>
<a name="l00892"></a>00892 <span class="comment">#    1 [  7.2636e-01 ] : VDWT:OW</span>
<a name="l00893"></a>00893 <span class="comment">#    2 [  9.6001e-02 ] : BONDSB:HWOW</span>
<a name="l00894"></a>00894 <span class="comment">#    3 [  4.5876e+05 ] : BONDSK:HWOW</span>
<a name="l00895"></a>00895 <span class="comment">#    4 [  1.0538e+02 ] : ANGLESB:HWOWHW</span>
<a name="l00896"></a>00896 <span class="comment">#    5 [  4.0540e+02 ] : ANGLESK:HWOWHW</span>
<a name="l00897"></a>00897 <span class="comment">#    6 [  5.1621e-01 ] : COUL:SOL-2 COUL:SOL-3</span>
<a name="l00898"></a>00898 <span class="comment">#    7 [ -1.0324e+00 ] : COUL:SOL-4</span>
<a name="l00899"></a>00899 <span class="comment">#    8 [  1.3278e-01 ] : VSITE3B:SOL-4 VSITE3A:SOL-4</span>
<a name="l00900"></a>00900 <span class="comment"># ----------------------------------------------------------</span>
<a name="l00901"></a>00901 <span class="comment"># @endverbatim</span>
<a name="l00902"></a>00902 <span class="comment"># </span>
<a name="l00903"></a>00903 <span class="comment"># As you can see, the objective function has decreased considerably</span>
<a name="l00904"></a>00904 <span class="comment"># since the previous step, and most of the improvement was due to</span>
<a name="l00905"></a>00905 <span class="comment"># reducing the error in the atomistic forces.  In the \c result</span>
<a name="l00906"></a>00906 <span class="comment"># directory, you will find an updated \c water.itp file with the</span>
<a name="l00907"></a>00907 <span class="comment"># optimized parameter values.  </span>
<a name="l00908"></a>00908 <span class="comment"># </span>
<a name="l00909"></a>00909 <span class="comment"># This newly generated force field is a better fit to the reference</span>
<a name="l00910"></a>00910 <span class="comment"># data, but is it actually a better force field or did we just overfit</span>
<a name="l00911"></a>00911 <span class="comment"># the data?  To answer this question, look at \c validate.in where the</span>
<a name="l00912"></a>00912 <span class="comment"># job type is set to \c single, and there are many more targets.  In</span>
<a name="l00913"></a>00913 <span class="comment"># particular, we are now including QM energies and forces for many</span>
<a name="l00914"></a>00914 <span class="comment"># cluster sizes ranging from 2 to 12.</span>
<a name="l00915"></a>00915 <span class="comment"># </span>
<a name="l00916"></a>00916 <span class="comment"># Take the \c read_mvals section from the output file of your previous</span>
<a name="l00917"></a>00917 <span class="comment"># run, paste it intointo the \c $options section of \c validate.in, and run</span>
<a name="l00918"></a>00918 <span class="comment"># &lt;tt&gt;ForceBalance.py validate.in&lt;/tt&gt; .  ForceBalance will now evaluate</span>
<a name="l00919"></a>00919 <span class="comment"># the objective function using the force field parameters from the</span>
<a name="l00920"></a>00920 <span class="comment"># previous optimization.</span>
<a name="l00921"></a>00921 <span class="comment"># </span>
<a name="l00922"></a>00922 <span class="comment"># You should see the following output:</span>
<a name="l00923"></a>00923 <span class="comment"># </span>
<a name="l00924"></a>00924 <span class="comment"># @verbatim</span>
<a name="l00925"></a>00925 <span class="comment"># Target: cluster-02      Errors: Energy =   2.7005 kJ/mol (30.0302%) Atomic Force (%) =  21.6334 Objective = 6.72502e-02</span>
<a name="l00926"></a>00926 <span class="comment"># Target: cluster-03      Errors: Energy =   4.2160 kJ/mol (31.5392%) Atomic Force (%) =  20.9368 Objective = 7.16864e-02</span>
<a name="l00927"></a>00927 <span class="comment"># Target: cluster-04      Errors: Energy =   5.3841 kJ/mol (31.5522%) Atomic Force (%) =  20.9395 Objective = 7.16537e-02</span>
<a name="l00928"></a>00928 <span class="comment"># Target: cluster-05      Errors: Energy =   6.5485 kJ/mol (31.2916%) Atomic Force (%) =  20.8474 Objective = 7.07190e-02</span>
<a name="l00929"></a>00929 <span class="comment"># Target: cluster-06      Errors: Energy =   8.0790 kJ/mol (29.5789%) Atomic Force (%) =  20.9879 Objective = 6.57372e-02</span>
<a name="l00930"></a>00930 <span class="comment"># Target: cluster-07      Errors: Energy =   9.1547 kJ/mol (32.1196%) Atomic Force (%) =  21.3219 Objective = 7.43141e-02</span>
<a name="l00931"></a>00931 <span class="comment"># Target: cluster-08      Errors: Energy =  10.0994 kJ/mol (29.7233%) Atomic Force (%) =  21.4583 Objective = 6.71937e-02</span>
<a name="l00932"></a>00932 <span class="comment"># Target: cluster-09      Errors: Energy =  10.8303 kJ/mol (29.2515%) Atomic Force (%) =  21.1871 Objective = 6.52168e-02</span>
<a name="l00933"></a>00933 <span class="comment"># Target: cluster-10      Errors: Energy =  11.5504 kJ/mol (28.5596%) Atomic Force (%) =  21.3929 Objective = 6.36629e-02</span>
<a name="l00934"></a>00934 <span class="comment"># Target: cluster-11      Errors: Energy =  12.8864 kJ/mol (27.3796%) Atomic Force (%) =  21.4805 Objective = 6.05357e-02</span>
<a name="l00935"></a>00935 <span class="comment"># Target: cluster-12      Errors: Energy =  13.1380 kJ/mol (27.7491%) Atomic Force (%) =  21.2593 Objective = 6.10940e-02</span>
<a name="l00936"></a>00936 <span class="comment"># Target: cluster-13      Errors: Energy =  13.8261 kJ/mol (27.3540%) Atomic Force (%) =  21.4092 Objective = 6.03483e-02</span>
<a name="l00937"></a>00937 <span class="comment"># Target: cluster-14      Errors: Energy =  14.1857 kJ/mol (25.8886%) Atomic Force (%) =  21.3174 Objective = 5.62253e-02</span>
<a name="l00938"></a>00938 <span class="comment"># </span>
<a name="l00939"></a>00939 <span class="comment"># ######################################################################</span>
<a name="l00940"></a>00940 <span class="comment"># ###                  Objective Function Breakdown                  ###</span>
<a name="l00941"></a>00941 <span class="comment"># ###  Target Name              Residual  x  Weight  =  Contribution ###</span>
<a name="l00942"></a>00942 <span class="comment"># ######################################################################</span>
<a name="l00943"></a>00943 <span class="comment"># cluster-02                     0.06725      0.077      5.17309e-03 </span>
<a name="l00944"></a>00944 <span class="comment"># cluster-03                     0.07169      0.077      5.51434e-03 </span>
<a name="l00945"></a>00945 <span class="comment"># cluster-04                     0.07165      0.077      5.51182e-03 </span>
<a name="l00946"></a>00946 <span class="comment"># cluster-05                     0.07072      0.077      5.43992e-03 </span>
<a name="l00947"></a>00947 <span class="comment"># cluster-06                     0.06574      0.077      5.05671e-03 </span>
<a name="l00948"></a>00948 <span class="comment"># cluster-07                     0.07431      0.077      5.71647e-03 </span>
<a name="l00949"></a>00949 <span class="comment"># cluster-08                     0.06719      0.077      5.16875e-03 </span>
<a name="l00950"></a>00950 <span class="comment"># cluster-09                     0.06522      0.077      5.01668e-03 </span>
<a name="l00951"></a>00951 <span class="comment"># cluster-10                     0.06366      0.077      4.89714e-03 </span>
<a name="l00952"></a>00952 <span class="comment"># cluster-11                     0.06054      0.077      4.65659e-03 </span>
<a name="l00953"></a>00953 <span class="comment"># cluster-12                     0.06109      0.077      4.69954e-03 </span>
<a name="l00954"></a>00954 <span class="comment"># cluster-13                     0.06035      0.077      4.64217e-03 </span>
<a name="l00955"></a>00955 <span class="comment"># cluster-14                     0.05623      0.077      4.32502e-03 </span>
<a name="l00956"></a>00956 <span class="comment"># Regularization                 0.00148      1.000      1.48379e-03 </span>
<a name="l00957"></a>00957 <span class="comment"># Total                                                  6.73020e-02 </span>
<a name="l00958"></a>00958 <span class="comment"># ----------------------------------------------------------------------</span>
<a name="l00959"></a>00959 <span class="comment"># @endverbatim</span>
<a name="l00960"></a>00960 <span class="comment"># </span>
<a name="l00961"></a>00961 <span class="comment"># As you can see, the agreement is comparable for all of the cluster</span>
<a name="l00962"></a>00962 <span class="comment"># sizes, and this effectively means that we were able to achieve an</span>
<a name="l00963"></a>00963 <span class="comment"># accurate fit to QM energies and forces for a wide range of cluster</span>
<a name="l00964"></a>00964 <span class="comment"># sizes using only the 6-mers and 12-mers.  </span>
<a name="l00965"></a>00965 <span class="comment"># </span>
<a name="l00966"></a>00966 <span class="comment"># A truly good force field needs to accurately reproduce experimental</span>
<a name="l00967"></a>00967 <span class="comment"># measurements, but these are more difficult to compute and optimize.</span>
<a name="l00968"></a>00968 <span class="comment"># ForceBalance provides methods for optimizing using experimental</span>
<a name="l00969"></a>00969 <span class="comment"># targets, but it is beyond the scope of this tutorial.  However,</span>
<a name="l00970"></a>00970 <span class="comment"># hopefully this simple example helps to explain how force field</span>
<a name="l00971"></a>00971 <span class="comment"># optimization works within the framework of ForceBalance.</span>
<a name="l00972"></a>00972 <span class="comment"># </span>
<a name="l00973"></a>00973 <span class="comment"># Feel free to explore using the other provided input files:</span>
<a name="l00974"></a>00974 <span class="comment"># </span>
<a name="l00975"></a>00975 <span class="comment"># @li \c 0.energy_force.in uses all of the targets - cluster sizes 2 through 14 - in the optimization.</span>
<a name="l00976"></a>00976 <span class="comment"># @li \c 1.netforce_torque.in includes net forces on water molecules and torques in the optimization.</span>
<a name="l00977"></a>00977 <span class="comment"># @li \c 2.L1_penalty.in uses a L1 penalty function, effectively causing only some parameters to change and not others.</span>
<a name="l00978"></a>00978 <span class="comment"># @li \c 3.no_penalty.in illustrates what happens when no penalty function is used at all.</span>
<a name="l00979"></a>00979 <span class="comment"># @li \c 4.change_factor.in shows the effect of changing the rescaling factors.</span>
<a name="l00980"></a>00980 <span class="comment"># @li \c 5.gradient.in performs a finite-difference check on the objective function gradient.</span>
<a name="l00981"></a>00981 <span class="comment"># </span>
<a name="l00982"></a>00982 <span class="comment"># \page glossary Glossary</span>
<a name="l00983"></a>00983 <span class="comment"># </span>
<a name="l00984"></a>00984 <span class="comment"># This is a glossary page containing scientific concepts for the discussion of</span>
<a name="l00985"></a>00985 <span class="comment"># potential optimization, as well as the (automatically generated) documentation</span>
<a name="l00986"></a>00986 <span class="comment"># of ForceBalance keywords.</span>
<a name="l00987"></a>00987 <span class="comment"># </span>
<a name="l00988"></a>00988 <span class="comment"># \section concepts Scientific concepts</span>
<a name="l00989"></a>00989 <span class="comment"># </span>
<a name="l00990"></a>00990 <span class="comment"># @li &lt;b&gt; Empirical parameter &lt;/b&gt; : Any adjustable parameter in the</span>
<a name="l00991"></a>00991 <span class="comment"># empirical potential that affects the potential energy, such as the</span>
<a name="l00992"></a>00992 <span class="comment"># partial charge on an atom, the equilibrium length of a chemical</span>
<a name="l00993"></a>00993 <span class="comment"># bond, or the fraction of Hartree-Fock exchange in a density functional.</span>
<a name="l00994"></a>00994 <span class="comment"># </span>
<a name="l00995"></a>00995 <span class="comment"># @li &lt;b&gt; Empirical Potential &lt;/b&gt; : A formula that contains empirical</span>
<a name="l00996"></a>00996 <span class="comment"># parameters and computes the potential energy of a collection of atoms.</span>
<a name="l00997"></a>00997 <span class="comment"># Note that in ForceBalance this is used very loosely; even a DFT</span>
<a name="l00998"></a>00998 <span class="comment"># functional may contain many empirical parameters, and ForceBalance has the</span>
<a name="l00999"></a>00999 <span class="comment"># ability to optimize these as well!</span>
<a name="l01000"></a>01000 <span class="comment"># </span>
<a name="l01001"></a>01001 <span class="comment"># @li &lt;b&gt; Target &lt;/b&gt; : A reference data set from high-level theoretical</span>
<a name="l01002"></a>01002 <span class="comment"># calculations or experimental measurements, paired with a procedure to</span>
<a name="l01003"></a>01003 <span class="comment"># simulate the same quantity using the force field.  The objective function</span>
<a name="l01004"></a>01004 <span class="comment"># is the sum of one or more targets.</span>
<a name="l01005"></a>01005 <span class="comment"># </span>
<a name="l01006"></a>01006 <span class="comment"># @li &lt;b&gt; Force field &lt;/b&gt; : This term is used interchangeably with</span>
<a name="l01007"></a>01007 <span class="comment"># empirical potential.</span>
<a name="l01008"></a>01008 <span class="comment"># </span>
<a name="l01009"></a>01009 <span class="comment"># @li &lt;b&gt; Functional form &lt;/b&gt; : The mathematical functions in the force</span>
<a name="l01010"></a>01010 <span class="comment"># field.  For instance, a CHARMM-type functional form has harmonic interactions</span>
<a name="l01011"></a>01011 <span class="comment"># for bonds and angles, a cosine expansion for the dihedrals, Coulomb interactions</span>
<a name="l01012"></a>01012 <span class="comment"># between point charges and Lennard-Jones terms for van der Waals interactions.</span>
<a name="l01013"></a>01013 <span class="comment"># </span>
<a name="l01014"></a>01014 <span class="comment"># @li &lt;b&gt; Reference data &lt;/b&gt; : In general, any accurately known</span>
<a name="l01015"></a>01015 <span class="comment"># quantity that the force field is optimized to reproduce.  Reference</span>
<a name="l01016"></a>01016 <span class="comment"># data can come from either theory or experiment.  For instance,</span>
<a name="l01017"></a>01017 <span class="comment"># energies and forces from a high-level QM method can be used as</span>
<a name="l01018"></a>01018 <span class="comment"># reference data (for instance, a CHARMM-type force field can be fitted</span>
<a name="l01019"></a>01019 <span class="comment"># to reproduce forces from a DFT or MP2 calculation), or a force field</span>
<a name="l01020"></a>01020 <span class="comment"># can be optimized to reproduce the experimental density of a liquid,</span>
<a name="l01021"></a>01021 <span class="comment"># its enthalpy of vaporization or the solvation free energy of a solute.</span>
<a name="l01022"></a>01022 <span class="comment"># </span>
<a name="l01023"></a>01023 <span class="comment"># \section gen_option_index Option index: General options</span>
<a name="l01024"></a>01024 <span class="comment"># </span>
<a name="l01025"></a>01025 <span class="comment"># This section contains a listing of the general options available when running</span>
<a name="l01026"></a>01026 <span class="comment"># a ForceBalance job, which go into the $options section.  The general options</span>
<a name="l01027"></a>01027 <span class="comment"># are global for the ForceBalance job, in contrast to &#39;Target options&#39; which apply to one</span>
<a name="l01028"></a>01028 <span class="comment"># target within a job (described in the next section).</span>
<a name="l01029"></a>01029 <span class="comment"># The option index is generated by running make-option-index.py.</span>
<a name="l01030"></a>01030 <span class="comment"># </span>
<a name="l01031"></a>01031 <span class="comment"># @li &lt;b&gt; ADAPTIVE_DAMPING &lt;/b&gt; (Float)</span>
<a name="l01032"></a>01032 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01033"></a>01033 <span class="comment"># </span>
<a name="l01034"></a>01034 <span class="comment"># @li &lt;b&gt; ADAPTIVE_FACTOR &lt;/b&gt; (Float)</span>
<a name="l01035"></a>01035 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01036"></a>01036 <span class="comment"># </span>
<a name="l01037"></a>01037 <span class="comment"># @li &lt;b&gt; AMOEBA_POLARIZATION &lt;/b&gt; (String)</span>
<a name="l01038"></a>01038 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01039"></a>01039 <span class="comment"># </span>
<a name="l01040"></a>01040 <span class="comment"># @li &lt;b&gt; ASYNCHRONOUS &lt;/b&gt; (Bool)</span>
<a name="l01041"></a>01041 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01042"></a>01042 <span class="comment"># </span>
<a name="l01043"></a>01043 <span class="comment"># @li &lt;b&gt; BACKUP &lt;/b&gt; (Bool)</span>
<a name="l01044"></a>01044 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (Optional)</span>
<a name="l01045"></a>01045 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 10</span>
<a name="l01046"></a>01046 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 1</span>
<a name="l01047"></a>01047 <span class="comment"># </span>
<a name="l01048"></a>01048 <span class="comment"># @li &lt;b&gt; CONSTRAIN_CHARGE &lt;/b&gt; (Bool)</span>
<a name="l01049"></a>01049 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01050"></a>01050 <span class="comment"># </span>
<a name="l01051"></a>01051 <span class="comment"># @li &lt;b&gt; CONVERGENCE_GRADIENT &lt;/b&gt; (Float)</span>
<a name="l01052"></a>01052 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01053"></a>01053 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01054"></a>01054 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer will quit when the objective function gradient falls below this number.</span>
<a name="l01055"></a>01055 <span class="comment">#                                           Since this is a newly implemented option, I can&#39;t say when this option will fail.</span>
<a name="l01056"></a>01056 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0001</span>
<a name="l01057"></a>01057 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Leave at the default, or set to several orders of magnitude below a typical value of the gradient (perhaps the gradient at the start of the optimization.)</span>
<a name="l01058"></a>01058 <span class="comment"># </span>
<a name="l01059"></a>01059 <span class="comment"># @li &lt;b&gt; CONVERGENCE_OBJECTIVE &lt;/b&gt; (Float)</span>
<a name="l01060"></a>01060 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01061"></a>01061 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01062"></a>01062 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer will quit when the last ten good values of the objective function have a</span>
<a name="l01063"></a>01063 <span class="comment">#                                            standard deviation that falls below this number.  We use the last ten good values (instead of the latest</span>
<a name="l01064"></a>01064 <span class="comment">#                                            change in the objective function), otherwise this condition would be triggered by taking tiny steps.</span>
<a name="l01065"></a>01065 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0001</span>
<a name="l01066"></a>01066 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Decrease this value if it&#39;s being triggered by small step sizes.</span>
<a name="l01067"></a>01067 <span class="comment"># </span>
<a name="l01068"></a>01068 <span class="comment"># @li &lt;b&gt; CONVERGENCE_STEP &lt;/b&gt; (Float)</span>
<a name="l01069"></a>01069 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01070"></a>01070 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01071"></a>01071 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer will quit when the step size falls below this number.  This happens if we are</span>
<a name="l01072"></a>01072 <span class="comment">#                                       approaching a local minimum, or if the optimizer is constantly taking bad steps and the trust radius is</span>
<a name="l01073"></a>01073 <span class="comment">#                                       reduced until it falls below this number.  In the latter case, this usually means that the derivatives are</span>
<a name="l01074"></a>01074 <span class="comment">#                                       wrong.</span>
<a name="l01075"></a>01075 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0001</span>
<a name="l01076"></a>01076 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Make sure that this value is much smaller than trust0.</span>
<a name="l01077"></a>01077 <span class="comment"># </span>
<a name="l01078"></a>01078 <span class="comment"># @li &lt;b&gt; EIG_LOWERBOUND &lt;/b&gt; (Float)</span>
<a name="l01079"></a>01079 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01080"></a>01080 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 10</span>
<a name="l01081"></a>01081 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer will misbehave if there are negative or very small eigenvalues in the</span>
<a name="l01082"></a>01082 <span class="comment">#                                     objective function Hessian.  In the former case the optimizer will travel toward a saddle point (or</span>
<a name="l01083"></a>01083 <span class="comment">#                                     local maximum), and in the latter case the matrix inversion will fail because of the matrix singularity.</span>
<a name="l01084"></a>01084 <span class="comment">#                                     If the smallest eigenvalue is below this value, then a multiple of the identity matrix is added to the</span>
<a name="l01085"></a>01085 <span class="comment">#                                     Hessian to increase the smallest eigenvalue to at least this value.</span>
<a name="l01086"></a>01086 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0001</span>
<a name="l01087"></a>01087 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Shouldn&#39;t have to worry about this setting, unless the optimizer appears to be taking bad steps or inverting nearly singular matrices.</span>
<a name="l01088"></a>01088 <span class="comment"># </span>
<a name="l01089"></a>01089 <span class="comment"># @li &lt;b&gt; ERROR_TOLERANCE &lt;/b&gt; (Float)</span>
<a name="l01090"></a>01090 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01091"></a>01091 <span class="comment"># </span>
<a name="l01092"></a>01092 <span class="comment"># @li &lt;b&gt; FFDIR &lt;/b&gt; (String)</span>
<a name="l01093"></a>01093 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (Optional)</span>
<a name="l01094"></a>01094 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01095"></a>01095 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: forcefield</span>
<a name="l01096"></a>01096 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Unless you&#39;re using a nonstandard location for force field files, you probably shouldn&#39;t change this.</span>
<a name="l01097"></a>01097 <span class="comment"># </span>
<a name="l01098"></a>01098 <span class="comment"># @li &lt;b&gt; FINITE_DIFFERENCE_H &lt;/b&gt; (Float)</span>
<a name="l01099"></a>01099 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: fdcheck_G or fdcheck_H job types, or whenever the objective function is evaluated using finite difference (Optional)</span>
<a name="l01100"></a>01100 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 50</span>
<a name="l01101"></a>01101 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: When the objective function derivatives are checked using finite difference, or when the objective function derivative</span>
<a name="l01102"></a>01102 <span class="comment">#                                          requires finite difference, this is the step size that is used (in the mathematical space).  The actual parameter in the</span>
<a name="l01103"></a>01103 <span class="comment">#                                          force field is changed by this amount times the rescaling factor.</span>
<a name="l01104"></a>01104 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.001</span>
<a name="l01105"></a>01105 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: 1e-2 to 1e-4; run FDCheckG to see if derivatives are accurate; if derivatives are inaccurate then adjust accordingly.</span>
<a name="l01106"></a>01106 <span class="comment">#                                          If the objective function itself requires finite difference, there will still be a difference because FDCheckG(H) uses an accurate</span>
<a name="l01107"></a>01107 <span class="comment">#                                          seven-point (five-point) stencil.  Make sure that the derivatives agree before settling on a value to use.</span>
<a name="l01108"></a>01108 <span class="comment"># </span>
<a name="l01109"></a>01109 <span class="comment"># @li &lt;b&gt; FORCEFIELD &lt;/b&gt; (List)</span>
<a name="l01110"></a>01110 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01111"></a>01111 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 200</span>
<a name="l01112"></a>01112 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: []</span>
<a name="l01113"></a>01113 <span class="comment"># </span>
<a name="l01114"></a>01114 <span class="comment"># @li &lt;b&gt; GMXPATH &lt;/b&gt; (String)</span>
<a name="l01115"></a>01115 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Targets that use GROMACS (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01116"></a>01116 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 60</span>
<a name="l01117"></a>01117 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Specify the path where GROMACS executables are installed, most likely ending in &#39;bin&#39;.</span>
<a name="l01118"></a>01118 <span class="comment">#                              Note that executables are only installed &#39;bin&#39; if the program is installed using &#39;make install&#39;;</span>
<a name="l01119"></a>01119 <span class="comment">#                              this will NOT be the case if you simply ran &#39;make&#39;.</span>
<a name="l01120"></a>01120 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: /home/leeping/opt/gromacs-4.5.5/bin</span>
<a name="l01121"></a>01121 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Depends on your local installation and environment.</span>
<a name="l01122"></a>01122 <span class="comment"># </span>
<a name="l01123"></a>01123 <span class="comment"># @li &lt;b&gt; GMXSUFFIX &lt;/b&gt; (String)</span>
<a name="l01124"></a>01124 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Targets that use GROMACS (Optional)</span>
<a name="l01125"></a>01125 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 60</span>
<a name="l01126"></a>01126 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Depending on how GROMACS is configured and installed, a suffix may be appended to executable</span>
<a name="l01127"></a>01127 <span class="comment">#                                names.  If there is a suffix, it needs to be specified here (or else ForceBalance will not find the</span>
<a name="l01128"></a>01128 <span class="comment">#                                GROMACS executable and it will crash.</span>
<a name="l01129"></a>01129 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: </span>
<a name="l01130"></a>01130 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Depends on your local installation and environment.</span>
<a name="l01131"></a>01131 <span class="comment"># </span>
<a name="l01132"></a>01132 <span class="comment"># @li &lt;b&gt; HAVE_VSITE &lt;/b&gt; (Bool)</span>
<a name="l01133"></a>01133 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01134"></a>01134 <span class="comment"># </span>
<a name="l01135"></a>01135 <span class="comment"># @li &lt;b&gt; JOBTYPE &lt;/b&gt; (Allcap)</span>
<a name="l01136"></a>01136 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01137"></a>01137 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 200</span>
<a name="l01138"></a>01138 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Here you may specify the type of ForceBalance job.  This ranges from gradient-based and stochastic</span>
<a name="l01139"></a>01139 <span class="comment">#                              optimizations to simple scans over the parameter space and finite difference checking of gradients.</span>
<a name="l01140"></a>01140 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: single</span>
<a name="l01141"></a>01141 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: See the Optimizer class documentation for which optimizer is best suited for you.</span>
<a name="l01142"></a>01142 <span class="comment"># </span>
<a name="l01143"></a>01143 <span class="comment"># @li &lt;b&gt; LM_GUESS &lt;/b&gt; (Float)</span>
<a name="l01144"></a>01144 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01145"></a>01145 <span class="comment"># </span>
<a name="l01146"></a>01146 <span class="comment"># @li &lt;b&gt; LOGARITHMIC_MAP &lt;/b&gt; (Bool)</span>
<a name="l01147"></a>01147 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01148"></a>01148 <span class="comment"># </span>
<a name="l01149"></a>01149 <span class="comment"># @li &lt;b&gt; MAXSTEP &lt;/b&gt; (Int)</span>
<a name="l01150"></a>01150 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All iterative optimization jobs (Optional)</span>
<a name="l01151"></a>01151 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 50</span>
<a name="l01152"></a>01152 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 100</span>
<a name="l01153"></a>01153 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: At least 100 optimization steps are recommended.</span>
<a name="l01154"></a>01154 <span class="comment"># </span>
<a name="l01155"></a>01155 <span class="comment"># @li &lt;b&gt; MINTRUST &lt;/b&gt; (Float)</span>
<a name="l01156"></a>01156 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01157"></a>01157 <span class="comment"># </span>
<a name="l01158"></a>01158 <span class="comment"># @li &lt;b&gt; NORMALIZE_WEIGHTS &lt;/b&gt; (Bool)</span>
<a name="l01159"></a>01159 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01160"></a>01160 <span class="comment"># </span>
<a name="l01161"></a>01161 <span class="comment"># @li &lt;b&gt; OBJECTIVE_HISTORY &lt;/b&gt; (Int)</span>
<a name="l01162"></a>01162 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01163"></a>01163 <span class="comment"># </span>
<a name="l01164"></a>01164 <span class="comment"># @li &lt;b&gt; PENALTY_ADDITIVE &lt;/b&gt; (Float)</span>
<a name="l01165"></a>01165 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Objective function (Optional)</span>
<a name="l01166"></a>01166 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 55</span>
<a name="l01167"></a>01167 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Add a penalty to the objective function (e.g. L2 or L1 norm) with this prefactor.</span>
<a name="l01168"></a>01168 <span class="comment">#                                       Using an additive penalty requires an assessment of the order of magnitude of the objective function,</span>
<a name="l01169"></a>01169 <span class="comment">#                                       but it is closer to the statistical concept of ridge or LASSO regression.</span>
<a name="l01170"></a>01170 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0</span>
<a name="l01171"></a>01171 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: No recommendation; run a single-point calculation to choose a prefactor.  Consider 0.01</span>
<a name="l01172"></a>01172 <span class="comment">#                                       for an objective function of order 1.</span>
<a name="l01173"></a>01173 <span class="comment"># </span>
<a name="l01174"></a>01174 <span class="comment"># @li &lt;b&gt; PENALTY_ALPHA &lt;/b&gt; (Float)</span>
<a name="l01175"></a>01175 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01176"></a>01176 <span class="comment"># </span>
<a name="l01177"></a>01177 <span class="comment"># @li &lt;b&gt; PENALTY_HYPERBOLIC_B &lt;/b&gt; (Float)</span>
<a name="l01178"></a>01178 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01179"></a>01179 <span class="comment"># </span>
<a name="l01180"></a>01180 <span class="comment"># @li &lt;b&gt; PENALTY_MULTIPLICATIVE &lt;/b&gt; (Float)</span>
<a name="l01181"></a>01181 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Objective function (Optional)</span>
<a name="l01182"></a>01182 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 55</span>
<a name="l01183"></a>01183 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Multiply the objective function by (1+X) where X is this value.</span>
<a name="l01184"></a>01184 <span class="comment">#                                             Using an multiplicative penalty works well for objective functions of any size but it is not</span>
<a name="l01185"></a>01185 <span class="comment">#                                             equivalent to statistical regularization methods.</span>
<a name="l01186"></a>01186 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0</span>
<a name="l01187"></a>01187 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: A value of 0.01 tends to keep the length of the parameter vector from exceeding 1.</span>
<a name="l01188"></a>01188 <span class="comment"># </span>
<a name="l01189"></a>01189 <span class="comment"># @li &lt;b&gt; PENALTY_TYPE &lt;/b&gt; (String)</span>
<a name="l01190"></a>01190 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (Optional)</span>
<a name="l01191"></a>01191 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01192"></a>01192 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: To prevent the optimization from changing the parameters too much, an additional penalty</span>
<a name="l01193"></a>01193 <span class="comment">#                                   is applied to the objective function that depends linearly (L1) or quadratically (L2) on the norm</span>
<a name="l01194"></a>01194 <span class="comment">#                                   of the parameter displacement vector.  L1 corresponds to LASSO regularization while L2 is known as</span>
<a name="l01195"></a>01195 <span class="comment">#                                   Tikhonov regularization or ridge regression.</span>
<a name="l01196"></a>01196 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: L2</span>
<a name="l01197"></a>01197 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: L2; tested and known to be working.  Implementation of L1 in progress.</span>
<a name="l01198"></a>01198 <span class="comment"># </span>
<a name="l01199"></a>01199 <span class="comment"># @li &lt;b&gt; PRINT_GRADIENT &lt;/b&gt; (Bool)</span>
<a name="l01200"></a>01200 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01201"></a>01201 <span class="comment"># </span>
<a name="l01202"></a>01202 <span class="comment"># @li &lt;b&gt; PRINT_HESSIAN &lt;/b&gt; (Bool)</span>
<a name="l01203"></a>01203 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01204"></a>01204 <span class="comment"># </span>
<a name="l01205"></a>01205 <span class="comment"># @li &lt;b&gt; PRINT_PARAMETERS &lt;/b&gt; (Bool)</span>
<a name="l01206"></a>01206 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01207"></a>01207 <span class="comment"># </span>
<a name="l01208"></a>01208 <span class="comment"># @li &lt;b&gt; PRIORS &lt;/b&gt; (Section)</span>
<a name="l01209"></a>01209 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01210"></a>01210 <span class="comment"># </span>
<a name="l01211"></a>01211 <span class="comment"># @li &lt;b&gt; READ_MVALS &lt;/b&gt; (Section)</span>
<a name="l01212"></a>01212 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (Optional)</span>
<a name="l01213"></a>01213 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01214"></a>01214 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Read in mathematical parameters before starting the optimization.  There is a standardized syntax, given by:</span>
<a name="l01215"></a>01215 <span class="comment"># @verbatim read_mvals</span>
<a name="l01216"></a>01216 <span class="comment"># 0 [ -2.9766e-01 ] : VDWSOW</span>
<a name="l01217"></a>01217 <span class="comment"># 1 [  2.2283e-01 ] : VDWTOW</span>
<a name="l01218"></a>01218 <span class="comment"># 2 [ -1.1138e-03 ] : BONDSBHWOW</span>
<a name="l01219"></a>01219 <span class="comment"># 3 [ -9.0883e-02 ] : BONDSKHWOW</span>
<a name="l01220"></a>01220 <span class="comment"># \read_mvals @endverbatim</span>
<a name="l01221"></a>01221 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01222"></a>01222 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: If you run the main optimizer, it will print out this block at the very end for you to use and/or modify.</span>
<a name="l01223"></a>01223 <span class="comment"># </span>
<a name="l01224"></a>01224 <span class="comment"># @li &lt;b&gt; READ_PVALS &lt;/b&gt; (Section)</span>
<a name="l01225"></a>01225 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All force field optimizations (Optional)</span>
<a name="l01226"></a>01226 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01227"></a>01227 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Read in physical parameters before starting the optimization.  There is a standardized</span>
<a name="l01228"></a>01228 <span class="comment">#                                 syntax, given by:</span>
<a name="l01229"></a>01229 <span class="comment"># @verbatim read_pvals</span>
<a name="l01230"></a>01230 <span class="comment">#  0 [  2.9961e-01 ] : VDWSOW</span>
<a name="l01231"></a>01231 <span class="comment">#  1 [  1.2009e+00 ] : VDWTOW</span>
<a name="l01232"></a>01232 <span class="comment">#  2 [  9.5661e-02 ] : BONDSBHWOW</span>
<a name="l01233"></a>01233 <span class="comment">#  3 [  4.1721e+05 ] : BONDSKHWOW</span>
<a name="l01234"></a>01234 <span class="comment">#  \read_pvals @endverbatim</span>
<a name="l01235"></a>01235 <span class="comment">#                                 These are the actual numbers that go into the force field file, so note the large changes in magnitude.</span>
<a name="l01236"></a>01236 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01237"></a>01237 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: If you run the main optimizer, it will print out this block at the very end for you to use and/or modify.</span>
<a name="l01238"></a>01238 <span class="comment"># </span>
<a name="l01239"></a>01239 <span class="comment"># @li &lt;b&gt; READCHK &lt;/b&gt; (String)</span>
<a name="l01240"></a>01240 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01241"></a>01241 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -50</span>
<a name="l01242"></a>01242 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer has the ability to pick up where it left off by reading / writing checkpoint</span>
<a name="l01243"></a>01243 <span class="comment">#                              files.  Here you may specify the checkpoint file to read in from a previous optimization run.  This is</span>
<a name="l01244"></a>01244 <span class="comment">#                              equivalent to reading in stored parameter values, except the gradient and Hessian (which contains memory from previous</span>
<a name="l01245"></a>01245 <span class="comment">#                              steps) is recorded too.</span>
<a name="l01246"></a>01246 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01247"></a>01247 <span class="comment"># </span>
<a name="l01248"></a>01248 <span class="comment"># @li &lt;b&gt; RIGID_WATER &lt;/b&gt; (Bool)</span>
<a name="l01249"></a>01249 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01250"></a>01250 <span class="comment"># </span>
<a name="l01251"></a>01251 <span class="comment"># @li &lt;b&gt; SCAN_VALS &lt;/b&gt; (String)</span>
<a name="l01252"></a>01252 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: scan_mvals and scan_pvals job types (Optional)</span>
<a name="l01253"></a>01253 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01254"></a>01254 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: This specifies a range of parameter values to scan in a uniform grid.  scan_mvals works in</span>
<a name="l01255"></a>01255 <span class="comment">#                                the mathematical parameter space while scan_pvals works in the physical parameter space.  The syntax</span>
<a name="l01256"></a>01256 <span class="comment">#                                is lower:step:upper .  Both lower and upper limits are included in the range.</span>
<a name="l01257"></a>01257 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01258"></a>01258 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: For scan_mvals, a range of values between -1 and +1 is recommended; for scan_pvals, choose values close to the physical parameter value.</span>
<a name="l01259"></a>01259 <span class="comment"># </span>
<a name="l01260"></a>01260 <span class="comment"># @li &lt;b&gt; SCANINDEX_NAME &lt;/b&gt; (List)</span>
<a name="l01261"></a>01261 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: scan_mvals and scan_pvals job types (Optional)</span>
<a name="l01262"></a>01262 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01263"></a>01263 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: ForceBalance assigns to each adjustable parameter a &#39;parameter name&#39;.  By specifying</span>
<a name="l01264"></a>01264 <span class="comment">#                                     this option, this tells the parameter scanner to locate the correct parameter with the specified name and then</span>
<a name="l01265"></a>01265 <span class="comment">#                                     scan over it.</span>
<a name="l01266"></a>01266 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: []</span>
<a name="l01267"></a>01267 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Look at the printout from a single-point job to determine the parameter names.</span>
<a name="l01268"></a>01268 <span class="comment"># </span>
<a name="l01269"></a>01269 <span class="comment"># @li &lt;b&gt; SCANINDEX_NUM &lt;/b&gt; (List)</span>
<a name="l01270"></a>01270 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: scan_mvals and scan_pvals job types (Optional)</span>
<a name="l01271"></a>01271 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01272"></a>01272 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: ForceBalance assigns to each adjustable parameter a &#39;parameter number&#39; corresponding to</span>
<a name="l01273"></a>01273 <span class="comment">#                                    its position in the parameter vector.  This tells the parameter scanner which number to scan over.</span>
<a name="l01274"></a>01274 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: []</span>
<a name="l01275"></a>01275 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Look at the printout from a single-point job to decide which parameter number you wish to scan over.</span>
<a name="l01276"></a>01276 <span class="comment"># </span>
<a name="l01277"></a>01277 <span class="comment"># @li &lt;b&gt; SEARCH_TOLERANCE &lt;/b&gt; (Float)</span>
<a name="l01278"></a>01278 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01279"></a>01279 <span class="comment"># </span>
<a name="l01280"></a>01280 <span class="comment"># @li &lt;b&gt; TINKERPATH &lt;/b&gt; (String)</span>
<a name="l01281"></a>01281 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Targets that use TINKER (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01282"></a>01282 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 60</span>
<a name="l01283"></a>01283 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: </span>
<a name="l01284"></a>01284 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Depends on your local installation and environment.</span>
<a name="l01285"></a>01285 <span class="comment"># </span>
<a name="l01286"></a>01286 <span class="comment"># @li &lt;b&gt; TRUST0 &lt;/b&gt; (Float)</span>
<a name="l01287"></a>01287 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01288"></a>01288 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 100</span>
<a name="l01289"></a>01289 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer uses a trust radius which &#39;adapts&#39; (i.e. increases or decreases) based on whether the last step</span>
<a name="l01290"></a>01290 <span class="comment">#                             was a good or bad step.  &#39;trust0&#39; provides the starting trust radius, and the trust radius is not allowed to increase too much</span>
<a name="l01291"></a>01291 <span class="comment">#                             from trust0.</span>
<a name="l01292"></a>01292 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.1</span>
<a name="l01293"></a>01293 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Increase from the default if the optimizer takes many good steps but takes too long; decrease if the optimizer takes many bad steps.</span>
<a name="l01294"></a>01294 <span class="comment"># </span>
<a name="l01295"></a>01295 <span class="comment"># @li &lt;b&gt; USE_PVALS &lt;/b&gt; (Bool)</span>
<a name="l01296"></a>01296 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01297"></a>01297 <span class="comment"># </span>
<a name="l01298"></a>01298 <span class="comment"># @li &lt;b&gt; VERBOSE_OPTIONS &lt;/b&gt; (Bool)</span>
<a name="l01299"></a>01299 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01300"></a>01300 <span class="comment"># </span>
<a name="l01301"></a>01301 <span class="comment"># @li &lt;b&gt; WQ_PORT &lt;/b&gt; (Int)</span>
<a name="l01302"></a>01302 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01303"></a>01303 <span class="comment"># </span>
<a name="l01304"></a>01304 <span class="comment"># @li &lt;b&gt; WRITECHK &lt;/b&gt; (String)</span>
<a name="l01305"></a>01305 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer (Optional)</span>
<a name="l01306"></a>01306 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -50</span>
<a name="l01307"></a>01307 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The main optimizer has the ability to pick up where it left off by reading / writing checkpoint</span>
<a name="l01308"></a>01308 <span class="comment">#                               files.  Here you may specify the checkpoint file to write after the job is finished.</span>
<a name="l01309"></a>01309 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01310"></a>01310 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Writing the checkpoint file is highly recommended.</span>
<a name="l01311"></a>01311 <span class="comment"># </span>
<a name="l01312"></a>01312 <span class="comment"># @li &lt;b&gt; WRITECHK_STEP &lt;/b&gt; (Bool)</span>
<a name="l01313"></a>01313 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Main optimizer when &#39;writechk&#39; is turned on (Optional)</span>
<a name="l01314"></a>01314 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -50</span>
<a name="l01315"></a>01315 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Write a checkpoint file every single step, not just after the job is finished.</span>
<a name="l01316"></a>01316 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 1</span>
<a name="l01317"></a>01317 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Useful if you want to quit an optimization before it finishes and restart, but make sure you don&#39;t overwrite existing checkpoint files by accident.</span>
<a name="l01318"></a>01318 <span class="comment"># </span>
<a name="l01319"></a>01319 <span class="comment"># \section tgt_option_index Option index: Target options</span>
<a name="l01320"></a>01320 <span class="comment"># </span>
<a name="l01321"></a>01321 <span class="comment"># This section contains a listing of the target options available when running</span>
<a name="l01322"></a>01322 <span class="comment"># a ForceBalance job, which go into the $tgt_opts section.  There can be multiple </span>
<a name="l01323"></a>01323 <span class="comment"># $tgt_opts sections in a ForceBalance input file, one for each target.</span>
<a name="l01324"></a>01324 <span class="comment"># </span>
<a name="l01325"></a>01325 <span class="comment"># @li &lt;b&gt; ABSOLUTE &lt;/b&gt; (Bool)</span>
<a name="l01326"></a>01326 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01327"></a>01327 <span class="comment"># </span>
<a name="l01328"></a>01328 <span class="comment"># @li &lt;b&gt; ALL_AT_ONCE &lt;/b&gt; (Bool)</span>
<a name="l01329"></a>01329 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01330"></a>01330 <span class="comment"># </span>
<a name="l01331"></a>01331 <span class="comment"># @li &lt;b&gt; ANISOTROPIC_BOX &lt;/b&gt; (Bool)</span>
<a name="l01332"></a>01332 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01333"></a>01333 <span class="comment"># </span>
<a name="l01334"></a>01334 <span class="comment"># @li &lt;b&gt; ATTENUATE &lt;/b&gt; (Bool)</span>
<a name="l01335"></a>01335 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01336"></a>01336 <span class="comment"># </span>
<a name="l01337"></a>01337 <span class="comment"># @li &lt;b&gt; BATCH_FD &lt;/b&gt; (Bool)</span>
<a name="l01338"></a>01338 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01339"></a>01339 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -150</span>
<a name="l01340"></a>01340 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: This is a stub for future functionality.  When the flag is switched on, the jobs corresponding to finite</span>
<a name="l01341"></a>01341 <span class="comment">#                               difference derivatives are evaluated in parallel on a distributed computing platform.</span>
<a name="l01342"></a>01342 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01343"></a>01343 <span class="comment"># </span>
<a name="l01344"></a>01344 <span class="comment"># @li &lt;b&gt; CAUCHY &lt;/b&gt; (Bool)</span>
<a name="l01345"></a>01345 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01346"></a>01346 <span class="comment"># </span>
<a name="l01347"></a>01347 <span class="comment"># @li &lt;b&gt; COVARIANCE &lt;/b&gt; (Bool)</span>
<a name="l01348"></a>01348 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01349"></a>01349 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01350"></a>01350 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The components of the energy and force contribution to the objective function are rescaled to be on the </span>
<a name="l01351"></a>01351 <span class="comment">#                                 same footing when the objective function is optimized.  This can be done by dividing each component by its variance,</span>
<a name="l01352"></a>01352 <span class="comment">#                                 or by multiplying the energy-force polytensor by the inverse of the quantum energy-force covariance matrix.  The</span>
<a name="l01353"></a>01353 <span class="comment">#                                 latter method was proposed as a way to emphasize intermolecular interactions but it is unproven.</span>
<a name="l01354"></a>01354 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01355"></a>01355 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: No recommendation; turn the covariance off if the number of snapshots is not much larger than</span>
<a name="l01356"></a>01356 <span class="comment">#                                 the number of coordinates.</span>
<a name="l01357"></a>01357 <span class="comment"># </span>
<a name="l01358"></a>01358 <span class="comment"># @li &lt;b&gt; DIPOLE_DENOM &lt;/b&gt; (Float)</span>
<a name="l01359"></a>01359 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01360"></a>01360 <span class="comment"># </span>
<a name="l01361"></a>01361 <span class="comment"># @li &lt;b&gt; DO_COSMO &lt;/b&gt; (Bool)</span>
<a name="l01362"></a>01362 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01363"></a>01363 <span class="comment"># </span>
<a name="l01364"></a>01364 <span class="comment"># @li &lt;b&gt; ENERGY &lt;/b&gt; (Bool)</span>
<a name="l01365"></a>01365 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01366"></a>01366 <span class="comment"># </span>
<a name="l01367"></a>01367 <span class="comment"># @li &lt;b&gt; ENERGY_DENOM &lt;/b&gt; (Float)</span>
<a name="l01368"></a>01368 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01369"></a>01369 <span class="comment"># </span>
<a name="l01370"></a>01370 <span class="comment"># @li &lt;b&gt; ENERGY_UPPER &lt;/b&gt; (Float)</span>
<a name="l01371"></a>01371 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01372"></a>01372 <span class="comment"># </span>
<a name="l01373"></a>01373 <span class="comment"># @li &lt;b&gt; FD_PTYPES &lt;/b&gt; (List)</span>
<a name="l01374"></a>01374 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01375"></a>01375 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01376"></a>01376 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: To compute the objective function derivatives, some components may require numerical finite difference in the derivatives.</span>
<a name="l01377"></a>01377 <span class="comment">#                              Here you may specify the parameter types that finite difference is applied to,</span>
<a name="l01378"></a>01378 <span class="comment">#                              or write &#39;ALL&#39; to take finite-difference derivatives in all parameter types.</span>
<a name="l01379"></a>01379 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: []</span>
<a name="l01380"></a>01380 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: If you aren&#39;t sure, either use &#39;ALL&#39; to do finite difference in each component (this is costly), or run a fdcheckG(H)</span>
<a name="l01381"></a>01381 <span class="comment">#                              job with this option set to &#39;NONE&#39; to check which analytic derivatives are missing.</span>
<a name="l01382"></a>01382 <span class="comment"># </span>
<a name="l01383"></a>01383 <span class="comment"># @li &lt;b&gt; FDGRAD &lt;/b&gt; (Bool)</span>
<a name="l01384"></a>01384 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01385"></a>01385 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01386"></a>01386 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: When this option is enabled, finite difference gradients will be enabled for selected parameter types </span>
<a name="l01387"></a>01387 <span class="comment">#                             (using the fd_ptypes option).  Gradients are computed using two-point finite difference of the objective function.</span>
<a name="l01388"></a>01388 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01389"></a>01389 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: If analytic derivatives are implemented (and correct), then they are much faster than finite difference</span>
<a name="l01390"></a>01390 <span class="comment">#                             derivatives.  Run the &#39;fdcheckG&#39; routine with this option set to Off to check which finite difference derivatives you need.</span>
<a name="l01391"></a>01391 <span class="comment"># </span>
<a name="l01392"></a>01392 <span class="comment"># @li &lt;b&gt; FDHESS &lt;/b&gt; (Bool)</span>
<a name="l01393"></a>01393 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01394"></a>01394 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01395"></a>01395 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: When this option is enabled, finite difference Hessians will be enabled for selected parameter types </span>
<a name="l01396"></a>01396 <span class="comment">#                             (using the fd_ptypes option).  Hessians are computed using two-point finite difference of the gradient.</span>
<a name="l01397"></a>01397 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01398"></a>01398 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Run the &#39;fdcheckH&#39; routine with this option set to Off to check which finite difference Hessian elements you need.</span>
<a name="l01399"></a>01399 <span class="comment">#                             Note that this requires a very large number of objective function evaluations, so use sparingly.</span>
<a name="l01400"></a>01400 <span class="comment"># </span>
<a name="l01401"></a>01401 <span class="comment"># @li &lt;b&gt; FDHESSDIAG &lt;/b&gt; (Bool)</span>
<a name="l01402"></a>01402 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01403"></a>01403 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01404"></a>01404 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: When this option is enabled, finite difference gradients and Hessian diagonal elements will be enabled </span>
<a name="l01405"></a>01405 <span class="comment">#                                 for selected parameter types (using the fd_ptypes option).  This is done using a three-point finite difference of</span>
<a name="l01406"></a>01406 <span class="comment">#                                 the objective function.</span>
<a name="l01407"></a>01407 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01408"></a>01408 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Use this as a substitute for &#39;fdgrad&#39;; it doubles the cost but provides more accurate derivatives</span>
<a name="l01409"></a>01409 <span class="comment">#                                 plus the Hessian diagonal values (these are very nice for quasi-Newton optimizers like BFGS).</span>
<a name="l01410"></a>01410 <span class="comment"># </span>
<a name="l01411"></a>01411 <span class="comment"># @li &lt;b&gt; FITATOMS &lt;/b&gt; (Int)</span>
<a name="l01412"></a>01412 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01413"></a>01413 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 0</span>
<a name="l01414"></a>01414 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: Choose a subset of atoms to fit forces to.  This is useful in situations where</span>
<a name="l01415"></a>01415 <span class="comment">#                               it is undesirable to fit the forces on part of the system (e.g. the part that is described by another force field.)</span>
<a name="l01416"></a>01416 <span class="comment">#                               Currently, you are only allowed to choose from the atoms in the front of the trajectory;</span>
<a name="l01417"></a>01417 <span class="comment">#                               soon this will be expanded for random flexibility (see &#39;shots&#39;).  However, random coordinate selections are not allowed. ;)</span>
<a name="l01418"></a>01418 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01419"></a>01419 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Situation-dependent; this should be based on the part of the system that you&#39;re fitting, or leave blank</span>
<a name="l01420"></a>01420 <span class="comment">#                               if you&#39;re fitting the whole system.</span>
<a name="l01421"></a>01421 <span class="comment"># </span>
<a name="l01422"></a>01422 <span class="comment"># @li &lt;b&gt; FORCE &lt;/b&gt; (Bool)</span>
<a name="l01423"></a>01423 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01424"></a>01424 <span class="comment"># </span>
<a name="l01425"></a>01425 <span class="comment"># @li &lt;b&gt; FORCE_CUDA &lt;/b&gt; (Bool)</span>
<a name="l01426"></a>01426 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01427"></a>01427 <span class="comment"># </span>
<a name="l01428"></a>01428 <span class="comment"># @li &lt;b&gt; FORCE_MAP &lt;/b&gt; (String)</span>
<a name="l01429"></a>01429 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01430"></a>01430 <span class="comment"># </span>
<a name="l01431"></a>01431 <span class="comment"># @li &lt;b&gt; FRAGMENT1 &lt;/b&gt; (String)</span>
<a name="l01432"></a>01432 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01433"></a>01433 <span class="comment"># </span>
<a name="l01434"></a>01434 <span class="comment"># @li &lt;b&gt; FRAGMENT2 &lt;/b&gt; (String)</span>
<a name="l01435"></a>01435 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01436"></a>01436 <span class="comment"># </span>
<a name="l01437"></a>01437 <span class="comment"># @li &lt;b&gt; HVAP_SUBAVERAGE &lt;/b&gt; (Bool)</span>
<a name="l01438"></a>01438 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01439"></a>01439 <span class="comment"># </span>
<a name="l01440"></a>01440 <span class="comment"># @li &lt;b&gt; LIQUID_EQU_STEPS &lt;/b&gt; (Int)</span>
<a name="l01441"></a>01441 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01442"></a>01442 <span class="comment"># </span>
<a name="l01443"></a>01443 <span class="comment"># @li &lt;b&gt; LIQUID_INTERVAL &lt;/b&gt; (Float)</span>
<a name="l01444"></a>01444 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01445"></a>01445 <span class="comment"># </span>
<a name="l01446"></a>01446 <span class="comment"># @li &lt;b&gt; LIQUID_PROD_STEPS &lt;/b&gt; (Int)</span>
<a name="l01447"></a>01447 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01448"></a>01448 <span class="comment"># </span>
<a name="l01449"></a>01449 <span class="comment"># @li &lt;b&gt; LIQUID_TIMESTEP &lt;/b&gt; (Float)</span>
<a name="l01450"></a>01450 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01451"></a>01451 <span class="comment"># </span>
<a name="l01452"></a>01452 <span class="comment"># @li &lt;b&gt; MANUAL &lt;/b&gt; (Bool)</span>
<a name="l01453"></a>01453 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01454"></a>01454 <span class="comment"># </span>
<a name="l01455"></a>01455 <span class="comment"># @li &lt;b&gt; MASTERFILE &lt;/b&gt; (String)</span>
<a name="l01456"></a>01456 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01457"></a>01457 <span class="comment"># </span>
<a name="l01458"></a>01458 <span class="comment"># @li &lt;b&gt; MTS_VVVR &lt;/b&gt; (Bool)</span>
<a name="l01459"></a>01459 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01460"></a>01460 <span class="comment"># </span>
<a name="l01461"></a>01461 <span class="comment"># @li &lt;b&gt; NAME &lt;/b&gt; (String)</span>
<a name="l01462"></a>01462 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All targets (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01463"></a>01463 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 200</span>
<a name="l01464"></a>01464 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01465"></a>01465 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Choose a descriptive name and make sure all targets have different names.</span>
<a name="l01466"></a>01466 <span class="comment"># </span>
<a name="l01467"></a>01467 <span class="comment"># @li &lt;b&gt; OPENMM_CUDA_PRECISION &lt;/b&gt; (String)</span>
<a name="l01468"></a>01468 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01469"></a>01469 <span class="comment"># </span>
<a name="l01470"></a>01470 <span class="comment"># @li &lt;b&gt; OPTIMIZE_GEOMETRY &lt;/b&gt; (Bool)</span>
<a name="l01471"></a>01471 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01472"></a>01472 <span class="comment"># </span>
<a name="l01473"></a>01473 <span class="comment"># @li &lt;b&gt; POLARIZABILITY_DENOM &lt;/b&gt; (Float)</span>
<a name="l01474"></a>01474 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01475"></a>01475 <span class="comment"># </span>
<a name="l01476"></a>01476 <span class="comment"># @li &lt;b&gt; QMBOLTZ &lt;/b&gt; (Float)</span>
<a name="l01477"></a>01477 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01478"></a>01478 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01479"></a>01479 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: When Boltzmann sampling is used to gather snapshots for force/energy matching, there is a potential</span>
<a name="l01480"></a>01480 <span class="comment">#                              ambiguity regarding which ensemble one should sample from (either the force field&#39;s ensemble or the QM calculation&#39;s</span>
<a name="l01481"></a>01481 <span class="comment">#                              ensemble.  The QM ensemble may be sampled using MM-sampled snapshots by reweighting; this tuning parameter specifies</span>
<a name="l01482"></a>01482 <span class="comment">#                              the fraction of QM Boltzmann weight to include.  Note that when two ensembles are different, reweighting will decrease</span>
<a name="l01483"></a>01483 <span class="comment">#                              the statistical significance of the number of snapshots (i.e. there is less InfoContent).</span>
<a name="l01484"></a>01484 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0.0</span>
<a name="l01485"></a>01485 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: If you want to reweight your snapshots entirely to the QM ensemble, choose 1.0; for hybrid weights,</span>
<a name="l01486"></a>01486 <span class="comment">#                              use 0.5.  Avoid if the there is a very large RMS energy difference between QM and MM.</span>
<a name="l01487"></a>01487 <span class="comment"># </span>
<a name="l01488"></a>01488 <span class="comment"># @li &lt;b&gt; QMBOLTZTEMP &lt;/b&gt; (Float)</span>
<a name="l01489"></a>01489 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01490"></a>01490 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01491"></a>01491 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: The reweighting of an ensemble involves an exponential of (DE)/kT, so there is a massive degradation of sample</span>
<a name="l01492"></a>01492 <span class="comment">#                                  quality if (DE) is large.  This option allows you to change the temperature in the denominator, which is unphysical (but</span>
<a name="l01493"></a>01493 <span class="comment">#                                  it does decrease the effect of moving toward the QM ensemble.</span>
<a name="l01494"></a>01494 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 298.15</span>
<a name="l01495"></a>01495 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Irrelevant if &#39;qmboltz&#39; is set to zero.  Leave at the default value unless you&#39;re performing experiments.</span>
<a name="l01496"></a>01496 <span class="comment"># </span>
<a name="l01497"></a>01497 <span class="comment"># @li &lt;b&gt; QUADRUPOLE_DENOM &lt;/b&gt; (Float)</span>
<a name="l01498"></a>01498 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01499"></a>01499 <span class="comment"># </span>
<a name="l01500"></a>01500 <span class="comment"># @li &lt;b&gt; RESP &lt;/b&gt; (Bool)</span>
<a name="l01501"></a>01501 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01502"></a>01502 <span class="comment"># </span>
<a name="l01503"></a>01503 <span class="comment"># @li &lt;b&gt; RESP_A &lt;/b&gt; (Float)</span>
<a name="l01504"></a>01504 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01505"></a>01505 <span class="comment"># </span>
<a name="l01506"></a>01506 <span class="comment"># @li &lt;b&gt; RESP_B &lt;/b&gt; (Float)</span>
<a name="l01507"></a>01507 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01508"></a>01508 <span class="comment"># </span>
<a name="l01509"></a>01509 <span class="comment"># @li &lt;b&gt; RMSD_DENOM &lt;/b&gt; (Float)</span>
<a name="l01510"></a>01510 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01511"></a>01511 <span class="comment"># </span>
<a name="l01512"></a>01512 <span class="comment"># @li &lt;b&gt; RUN_INTERNAL &lt;/b&gt; (Bool)</span>
<a name="l01513"></a>01513 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01514"></a>01514 <span class="comment"># </span>
<a name="l01515"></a>01515 <span class="comment"># @li &lt;b&gt; SAMPCORR &lt;/b&gt; (Bool)</span>
<a name="l01516"></a>01516 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01517"></a>01517 <span class="comment"># </span>
<a name="l01518"></a>01518 <span class="comment"># @li &lt;b&gt; SHOTS &lt;/b&gt; (Int)</span>
<a name="l01519"></a>01519 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01520"></a>01520 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 0</span>
<a name="l01521"></a>01521 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: This option allows you to choose a subset from the snapshots available in the force matching &#39;targets&#39; directory.</span>
<a name="l01522"></a>01522 <span class="comment">#                            The subset is simply taken from the front of the trajectory.</span>
<a name="l01523"></a>01523 <span class="comment">#                            In the future this option will be expanded to allow a random selection of snapshots, or a specific selection</span>
<a name="l01524"></a>01524 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: -1</span>
<a name="l01525"></a>01525 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: 100-10,000 snapshots are recommended.  Note that you need at least 3x (number of atoms) if</span>
<a name="l01526"></a>01526 <span class="comment">#                            the covariance matrix is turned on.</span>
<a name="l01527"></a>01527 <span class="comment"># </span>
<a name="l01528"></a>01528 <span class="comment"># @li &lt;b&gt; SLEEPY &lt;/b&gt; (Int)</span>
<a name="l01529"></a>01529 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01530"></a>01530 <span class="comment"># </span>
<a name="l01531"></a>01531 <span class="comment"># @li &lt;b&gt; TYPE &lt;/b&gt; (Allcap)</span>
<a name="l01532"></a>01532 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All targets (&lt;b&gt;&lt;em&gt;Required&lt;/em&gt;&lt;/b&gt;)</span>
<a name="l01533"></a>01533 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 200</span>
<a name="l01534"></a>01534 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: This is the type of target that you are running.  The current accepted values for the target type</span>
<a name="l01535"></a>01535 <span class="comment">#                              are given in the implemented.py file: COUNTERPOISE, ABINITIO_AMBER, ABINITIO_GMX, INTERACTION_OPENMM, LIQUID_OPENMM, ABINITIO_OPENMM, ABINITIO_TINKER, BINDINGENERGY_TINKER, MONOMER_QTPIE, RDVR3_PSI4, ABINITIO_INTERNAL, MOMENTS_TINKER, THCDF_PSI4, VIBRATION_TINKER, LIQUID_TINKER, INTERACTION_TINKER.</span>
<a name="l01536"></a>01536 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: None</span>
<a name="l01537"></a>01537 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Choose the appropriate type, and if the target type is missing, feel free to implement your own (or ask me for help).</span>
<a name="l01538"></a>01538 <span class="comment"># </span>
<a name="l01539"></a>01539 <span class="comment"># @li &lt;b&gt; W_ALPHA &lt;/b&gt; (Float)</span>
<a name="l01540"></a>01540 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01541"></a>01541 <span class="comment"># </span>
<a name="l01542"></a>01542 <span class="comment"># @li &lt;b&gt; W_CP &lt;/b&gt; (Float)</span>
<a name="l01543"></a>01543 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01544"></a>01544 <span class="comment"># </span>
<a name="l01545"></a>01545 <span class="comment"># @li &lt;b&gt; W_ENERGY &lt;/b&gt; (Float)</span>
<a name="l01546"></a>01546 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01547"></a>01547 <span class="comment"># </span>
<a name="l01548"></a>01548 <span class="comment"># @li &lt;b&gt; W_EPS0 &lt;/b&gt; (Float)</span>
<a name="l01549"></a>01549 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01550"></a>01550 <span class="comment"># </span>
<a name="l01551"></a>01551 <span class="comment"># @li &lt;b&gt; W_FORCE &lt;/b&gt; (Float)</span>
<a name="l01552"></a>01552 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01553"></a>01553 <span class="comment"># </span>
<a name="l01554"></a>01554 <span class="comment"># @li &lt;b&gt; W_HVAP &lt;/b&gt; (Float)</span>
<a name="l01555"></a>01555 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01556"></a>01556 <span class="comment"># </span>
<a name="l01557"></a>01557 <span class="comment"># @li &lt;b&gt; W_KAPPA &lt;/b&gt; (Float)</span>
<a name="l01558"></a>01558 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01559"></a>01559 <span class="comment"># </span>
<a name="l01560"></a>01560 <span class="comment"># @li &lt;b&gt; W_NETFORCE &lt;/b&gt; (Float)</span>
<a name="l01561"></a>01561 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01562"></a>01562 <span class="comment"># </span>
<a name="l01563"></a>01563 <span class="comment"># @li &lt;b&gt; W_RESP &lt;/b&gt; (Float)</span>
<a name="l01564"></a>01564 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01565"></a>01565 <span class="comment"># </span>
<a name="l01566"></a>01566 <span class="comment"># @li &lt;b&gt; W_RHO &lt;/b&gt; (Float)</span>
<a name="l01567"></a>01567 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01568"></a>01568 <span class="comment"># </span>
<a name="l01569"></a>01569 <span class="comment"># @li &lt;b&gt; W_TORQUE &lt;/b&gt; (Float)</span>
<a name="l01570"></a>01570 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01571"></a>01571 <span class="comment"># </span>
<a name="l01572"></a>01572 <span class="comment"># @li &lt;b&gt; WAVENUMBER_TOL &lt;/b&gt; (Float)</span>
<a name="l01573"></a>01573 <span class="comment"># \n&lt;b&gt; Need to document &lt;/b&gt;</span>
<a name="l01574"></a>01574 <span class="comment"># </span>
<a name="l01575"></a>01575 <span class="comment"># @li &lt;b&gt; WEIGHT &lt;/b&gt; (Float)</span>
<a name="l01576"></a>01576 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: All target types (Optional)</span>
<a name="l01577"></a>01577 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: 150</span>
<a name="l01578"></a>01578 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: This option specifies the weight that the target will contribute to the objective function.</span>
<a name="l01579"></a>01579 <span class="comment">#                             A larger weight for a given target means that the optimizer will prioritize it over the others.</span>
<a name="l01580"></a>01580 <span class="comment">#                             When several targets are used, the weight should be chosen carefully such that all targets</span>
<a name="l01581"></a>01581 <span class="comment">#                             contribute a finite amount to the objective function.  Note that the choice of weight determines the final outcome</span>
<a name="l01582"></a>01582 <span class="comment">#                             of the force field, although we hope not by too much.</span>
<a name="l01583"></a>01583 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 1.0</span>
<a name="l01584"></a>01584 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: It is important to specify something here (giving everything equal weight is unlikely to work.)  </span>
<a name="l01585"></a>01585 <span class="comment">#                             Run a single-point objective function evaluation with all weights set to one to get a handle on</span>
<a name="l01586"></a>01586 <span class="comment">#                             the natural size of each target&#39;s contribution, and then add weights accordingly.</span>
<a name="l01587"></a>01587 <span class="comment"># </span>
<a name="l01588"></a>01588 <span class="comment"># @li &lt;b&gt; WHAMBOLTZ &lt;/b&gt; (Bool)</span>
<a name="l01589"></a>01589 <span class="comment"># \n&lt;b&gt; Scope &lt;/b&gt;: Force and energy matching (Optional)</span>
<a name="l01590"></a>01590 <span class="comment"># \n&lt;b&gt; One-line description &lt;/b&gt;: -100</span>
<a name="l01591"></a>01591 <span class="comment"># \n&lt;b&gt; Full description &lt;/b&gt;: In self-consistent energy/force matching projects, the data from previous cycles can be reused by applying the</span>
<a name="l01592"></a>01592 <span class="comment">#                                Weighted Histogram Analysis Method (WHAM).  However, the WHAM data is currently generated by external scripts that</span>
<a name="l01593"></a>01593 <span class="comment">#                                haven&#39;t made it into this distribution yet.  In the future, generation of WHAM data will be incorporated into this</span>
<a name="l01594"></a>01594 <span class="comment">#                                program automatically.</span>
<a name="l01595"></a>01595 <span class="comment"># \n&lt;b&gt; Default Value &lt;/b&gt;: 0</span>
<a name="l01596"></a>01596 <span class="comment"># \n&lt;b&gt; Recommendation &lt;/b&gt;: Leave off unless you have an externally generated wham-master.txt and wham-weights.txt files.</span>
<a name="l01597"></a>01597 <span class="comment"># </span>
<a name="l01598"></a>01598 <span class="comment"># </span>
<a name="l01599"></a>01599 <span class="comment"># \image latex ForceBalance.pdf &quot;Logo.&quot; height=10cm</span>
<a name="l01600"></a>01600 <span class="comment"># </span>
<a name="l01601"></a>01601 <span class="comment"># </span>
<a name="l01602"></a>01602 
<a name="l01603"></a>01603 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 14 2013 15:25:44 for ForceBalance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
